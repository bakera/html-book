＜タイトル＞
コメント
＜本文＞
HTMLにはコメントを書くこともできます。コメントは、ソースコード中では読むことができますが、原則として表示などには影響しません。

＜中見出し＞
コメントの基本書式
＜本文＞
コメントは、基本的に〓01〓のような形式になります。
<!--がコメントの開始、-->がコメントの終了を表すマークです。これらに囲まれた部分がコメントの内容となります。

〓01〓コメントの記述例
＜コード＞
<!--コメント-->

＜本文＞
コメントは表示に影響しないので、コンテンツ制作者が好きな内容を書くことができます。主に、HTMLのソースコードを読みやすくするために利用されます。ソースコード内のパーツの区切りを示したり、div要素などの終了タグがどの開始タグに対応するのかを書いたりできます〓02〓。
コメントは要素ではありません。コメントの中に含まれるテキストはテキストノードではなく、コメントノードという独自のノードとして扱われます。

＜memo＞
コメントはノードなので、DOMを通じてコメントノードの内容にアクセスできます。

＜本文＞
〓02〓コメントの利用例
＜コード＞
<!-- ヘッダー開始 -->
<div class="header">
...
<!--/header--></div>
<!-- ヘッダー終了 -->

＜中見出し＞
コメントの構文ルール
＜本文＞
コメントにはさまざまな内容を入れることができます。コメントには改行を含むことが許されるので、複数行のテキストを書くことができます〓03〓。

〓03〓複数行にわたるのコメント
＜コード＞
<!--
複数行にわたる
コメントも可能
-->

＜本文＞
コメントは空でも構いません。〓04〓は有効なコメントで、内容が空のコメントノードができます。
コメントの中に<を書くこともできます。コメントの中でタグを記述した場合はタグとはみなされず、そのままコメントノードの内容となります。よくあるパターンとしては、既存のマークアップを一時的に除外するコメントアウトに使われます〓05〓。

〓04〓空のコメント
＜コード＞
<!---->

〓05〓コメント内に<を記述した例
＜コード＞
<!--
<h1>見出し</h1>
<p>テキスト</p>
-->

＜本文＞
なお、>も書くこともできますが、>はコメントの内容の先頭に書くことができないという制限があります。〓06〓はエラーとなり、空のコメントノードが追加されます。これらはいずれも、エラー処理によって、〓07〓のようなマークアップと同じものとみなされます。

〓06〓>をコメントの先頭に記述した誤った例
＜コード＞
<!-->コメント-->
<!--->コメント-->

〓07〓ブラウザーによる〓06〓の解釈結果
＜コード＞
!---->コメント-->

＜memo＞
>をコメントの先頭に記述した場合、abrupt-closing-of-empty-comment parse errorというエラーとして扱われます。

＜memo＞
〓07〓でわかるように、〓06〓の-->部分はコメントとはみなされません。

＜中見出し＞
コメントは入れ子にできない
＜本文＞
要素とは異なり、コメントの中に他のコメントを入れ子にはできません。〓08〓はエラーとなる例です。エラーとなりますが、<!--はコメントの一部とみなされます。また、-->をコメントの中に入れようとすると、そこでコメントが終了したものとみなされます。そのため、前<!--内側というコメントノードと、後-->というテキストノードになります。

〓08〓コメントを入れ子にした例
＜コード＞
<!-- 前 <!--内側--> 後 -->

＜memo＞
入れ子にした場合、nested-comment parse errorというエラーとして扱われます。

＜本文＞
また、コメントの内容の末尾に<!-を書くこともできません。〓09〓は誤った例です。
〓09〓もコメントの中で別のコメントを入れ子にしようとしたものと解釈され、エラーとなります。

〓09〓コメント内容の末尾に<!-を記述した誤った例
＜コード＞
<!-- <!--->

＜中見出し＞
コメントの前後にスペースを挟む
＜本文＞
〓06〓や〓09〓のように、コメントの内容の先頭に>や->を書いたり、末尾に<!-を書くとエラーになります。しかし、スペースを挟めば問題ありません。〓10〓はいずれも正当なコメントです。

〓10〓スペースを挟んだ記述例
＜コード＞
<!-- >コメント -->
<!-- ->コメント -->
<!-- コメント<!- -->

＜本文＞
ただし、スペースを挟んだとしても、入れ子のコメントは書けないので、〓11〓はエラーになってしまいます。

〓11〓スペースがあってもエラーになる記述例
＜コード＞
<!-- <!-- -->

＜本文＞
コメントの前後にスペースを入れる習慣をつけておくと、エラーを避けやすくなります。「コメントの前後にスペースを入れるとよい、ただし入れ子のコメントは書けない」と覚えておくとよいでしょう。

＜中見出し＞
bogus comment
＜本文＞
過去のHTMLには、SGMLやXML由来の現在では使われていないマークが入っていることがあります。多くの場合、それらはコメントとみなすようになっています。このように、かつて使われていたマークで、現在はコメントとみなされるものをbogus commentと呼んでいます。本書ではbogus commentの一部を紹介します。

＜memo＞
bogusは「偽物の」という意味です。

＜小見出し＞
処理命令
＜本文＞
昔に作成されたXHTMLでは、先頭「XML宣言」いうマークが書かれることがあります〓12〓。

〓12〓XML宣言の例
＜コード＞
<?xml version="1.0" encoding="UTF-8" ?>

＜本文＞
XML宣言のような<?で始まるマークを「処理命令（Processing Instruction）」といいます。処理命令は、XML構文では意味を持ちますが、HTML構文では単にコメントとみなされます。つまり、〓12〓は〓13〓のようなコメントが書かれているものと解釈されます。

〓13〓HTML構文における〓12〓の処理結果
＜コード＞
<!--?xml version="1.0" encoding="UTF-8" ?-->

＜小見出し＞
CDATA区間
＜本文＞
HTMLには、「CDATA区間（CDATA Section）」と呼ばれるマークがあります。これはSGMLやXML由来の機能で、たとえば〓14〓のように書けます。

〓14〓SVG要素の中でのCDATA区間の記述例
＜コード＞
<svg width="20cm" height="2cm" viewBox="0 0 1000 40">
  <text>
  <![CDATA[
  <h1>CDATAのサンプル</h1>
  <p>XML構文ではタグは解釈されず、テキストとみなされます</p>
  ]]>
  </text>
</svg>

＜本文＞
<![CDATA[で始まり、]]>で終わるCDATA区間では、タグは解釈されず、すべてそのままのテキストとみなされます。
実際に〓14〓をブラウザーに解釈させると、〓15〓のように表示されます。CDATA区間では、<を&lt;とエスケープすることなく、<をそのまま記述できるのです。

〓15〓〓14〓をブラウザーで表示した例
＜囲み＞
<h1>CDATAのサンプル</h1> <p>XML構文ではタグは解釈されず、テキストとみなされます</p>
＜/囲み＞

＜memo＞
過去に作成されたXHTMLでは、CDATA区間の機能を利用して、script要素の中にCDATA区間を使ったケースがありました。

＜本文＞
しかし、現在のHTML構文では、CDATA区間は、svg要素のようなXMLを記述するコンテキストで出現した場合のみ機能します。
一般的なHTMLの要素の中では、CDATA区間は使えません。CDATA区間が出現した場合はエラーとなり、bogus commentとして処理されます。
〓15〓の例から、CDATA区間のみを抜き出してブラウザーに解釈させると、〓16〓のようなマークアップと等価になります。

＜memo＞
この場合、cdata-in-html-content errorというエラーになります。

〓16〓HTML構文で〓16〓をブラウザーで処理した結果
＜コード＞
<!--[CDATA[
<h1-->CDATAのサンプル
<p>XML構文ではタグは解釈されず、テキストとみなされます</p>
]]>
