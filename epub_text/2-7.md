# コメント

HTMLにはコメントを書くこともできます。コメントは、ソースコード中では読むことができますが、原則として表示などには影響しません。

## コメントの基本書式

コメントは、基本的に01のような形式になります。

01 コメントの記述例
```html
<!--コメント-->
```
`<!--`がコメントの開始、`-->`がコメントの終了を表すマークです。これらに囲まれた部分がコメントの内容となります。

コメントは表示に影響しないので、コンテンツ制作者は好きな内容を書くことができます。02のように、ソースコード内のパーツの区切りを明示したり、終了タグがどの開始タグに対応するかをメモしておくために利用できます。

02 コメントの利用例
```html
<!-- ヘッダー開始 --> 
<div class="header"> 
... 
<!--/header--></div> 
<!-- ヘッダー終了 --> 
```

コメントは、DOMツリー上ではコメントノードとして扱われます。

## コメントの構文ルール

コメントにはさまざまな内容が記述可能です。改行を含むことも許されるため、03のように複数行のテキストを書くことができます。

03 複数行にわたるコメント
```html
<!-- 
複数行にわたる 
コメントも可能 
--> 
```

コメントは空でも構いません。04は有効なコメントで、内容が空のコメントノードができます。

04 空のコメント
```html
<!---->
```

コメントの中に`<`を書くこともできます。コメントの中でタグを記述した場合はタグとはみなされず、そのままコメントノードの内容となります。よくあるパターンとしては、既存のマークアップを一時的に除外するコメントアウトに使われます。

05 コメント内に<を記述した例
```html
<!--
<h1>見出し</h1>
<p>テキスト</p>
-->

`>`も書けますが、コメント内容の先頭には記述できないという制限があります。06は構文エラーとなり、空のコメントノードが追加されます。

06 >をコメントの先頭に記述した誤った例
```html
<!-->コメント-->
<!--->コメント-->
```

06は構文エラーとなり、空のコメントノードが追加されます。06 は、いずれもエラー処理によって、07のようなマークアップと同じものとみなされます。

07 ブラウザーによる 06 の解釈結果

```html
<!---->コメント-->
```

メモ
コメントは表示されませんが、DOMツリー上にはコメントノードとして存在するため、JavaScriptから内容を読み取ることができます。DOMツリーについてはCHAPTER 1-2も参照してください。

メモ
>をコメントの先頭に記述した場合、abrupt-closing-of-emptycommentparse errorというエラーとして扱われます。

メモ
07 からわかるように、06 の行末にある--> 部分はコメントとはみなされません。

## コメントは入れ子にできない

要素とは異なり、コメントは入れ子にできません。08はエラーとなる例です。

08 コメントを入れ子にした例
```html
<!-- 前 <!--内側--> 後 -->
```

エラーとなりますが、`<!--`はコメントの一部とみなされます。また、`-->`をコメントの中に入れようとすると、そこでコメントが終了したものとみなされます。そのため、「`前<!-- 内側`」というコメントノードと、「`後-->`」というテキストノードになります。

また、コメントの内容の末尾に`<!-`を書くこともできません。09はコメントを入れ子にしようとしたものと解釈され、構文エラーとなります。

09 コメント内容の末尾に<!-を記述した誤った例
```html
<!-- <!--->
```

メモ
入れ子にした場合、n e s t e d -comment parse error というエラーとして扱われます。

## コメントの前後にスペースを挟む

06や09のように、コメントの内容の先頭に`>`や`->`を書いたり、末尾に`<!-`を書くとエラーになります。しかし、スペースを挟めば問題ありません。10はいずれも正しいコメントです。

10 スペースを挟んだ正しいコメントの記述例
```html
<!-- >コメント -->
<!-- ->コメント -->
<!-- コメント<!- -->
```

ただし、スペースを挟んだとしても、入れ子のコメントは書けないので、11は構文エラーとなります。

11 スペースがあってもエラーになるコメントの記述例

```html
<!-- <!-- -->
```

コメントの前後にスペースを入れる習慣をつけておくと、エラーを避やすくなります。「コメントの前後にスペースを入れるとよい、ただし入れ子のコメントは書けない」と覚えておくとよいでしょう。

## Bogus Comment

HTML構文の場合、SGMLやXMLで使われる宣言などのマークのほとんどは、元の意味通りには解釈されず、構文エラーとなります。そして、エラー処理の結果、コメントとみなされます。このように、マークがコメントとして処理されたものをbogus commentと呼びます。12はboguscommentとなるマークの例です。

12 bogus commentとなるマークの例
```xml
<!-- 実体宣言 --> 
<!ENTITY external-file SYSTEM "external.xml"> 
```

これらは13のように解釈されます。

```html
<!--ENTITY external-file SYSTEM "external.xml"-->
```

これらは13 のように解釈されます。

13 現在のHTML構文における12の解釈
```html
<!--ENTITY external-file SYSTEM "external.xml"-->
```

メモ
bogusは「偽物の」という意味です。

XML構文の場合、12のマークはいずれもXMLのマークとして、本来の意味通りに解釈されます。HTML構文の例外として、`svg`要素と`math`要素の中のCDATA区間はbogus commentとはならず、CDATA区間として解釈されます。`<![CDATA[`で始まり、`]]>`で終わるCDATA区間の中では、マークは解釈されず、すべて単なるテキストとみなされます。14は`svg`要素の中でCDATA区間を利用した例です。

14 svg要素の中でのCDATA区間の記述例
```html

<svg width="20cm" height="2cm" viewBox="0 0 1000 40"> 
<text> 
<![CDATA[
<h1>CDATAのサンプル</h1>
<p>XML構文ではタグは解釈されず、テキストとみなされます</p> 
]]> 
</text> 
</svg>
```

14をブラウザーに解釈させると、15のように表示され、CDATA区間が適切に扱われていることがわかります。

15 14をブラウザーで表示した例


CDATA区間がscript要素の中に含まれている場合は、扱いが異なります。この場合、全体がそのままの文字列と解釈され、`<![CDATA[`という文字列も込みでそのままスクリプトエンジンに送られます。script要素についてはCHAPTER 3-13も参照してください。

このほか、終了タグのタグ名に不正な文字が使用されてい場合もboguscommentとして処理されます。
