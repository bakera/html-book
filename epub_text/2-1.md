# HTMLの要素とタグの基本

CHAPTER 1では、HTMLがマークアップ言語であることを説明しました。ここでは、HTMLの基本的な構文について説明していきます。

## 要素とタグ

マークアップとは、テキストにマークを付けて意味や構造を明確にすることです。HTMLは、テキストデータと、それに対するマークから成り立っています。

たとえば以下のようなテキストのかたまりがあったとします。

```text
これは見出しのテキストのかたまりです
これは本文です。
このキーワードはこの文章で重要なものを表します。
```

このテキストのかたまりには、見出し、本文、キーワードが含まれています。CHAPTER 1で触れたように、HTMLでは、こういったまとまりを「要素（element）」といいます。

マークアップ言語の役割は、要素を明示することです。要素を明示するには、以下の2つの情報が必要になります。

- 要素の種類：それがどのような要素なのか
- 要素の範囲：どこからどこまでがその要素になるのか 

HTMLでは、この情報を「タグ（tag）」と呼ばれるマークを使って表現します。さきほどの例にHTMLのタグを付け加えると、02のようになります。 

```html
<h1>これは見出しのテキストのかたまりです</h1>
<p>これは本文です。</p>
<p>この<mark>キーワード</mark>はこの文章で重要なものを表します。</p>
```

`<`（U+003C、不等号小なり）と`>`（U+003E、不等号大なり）で囲まれ
た部分がHTMLのタグです。最初の行の見出しは、先頭に`<h1>`のタグを、末尾に`</h1>`のタグを入れています。このように、要素の開始位置と終了位置にタグを入れることで、要素の種類とその範囲を明示します。

### 開始タグと終了タグ

要素の開始位置を表すタグを「開始タグ（start tag）」といいます。開始タグは`<`で始まり、`>`で終わります。`h1`と書かれた部分は「タグ名（tagname）」といい、要素の名前である「要素名（element name）」を表しています。

要素の終了位置を表すタグを「終了タグ（end tag）」といいます。開始タグとは異なり、`<`の直後に`/`（U+002F、スラッシュ）を置いた`</`で始まります。

タグを除いた要素の中身の部分を、要素の「内容（content）」[^1]といいます。

[^1]: 日本語に訳さず、コンテントやコンテンツと呼ばれることもあります。

もう一度、さきほどのマークアップを見てみましょう。

```html
<h1>これは見出しのテキストのかたまりです</h1>
<p>これは本文です。</p>
<p>この<mark>キーワード</mark>はこの文章で重要なものを表します。</p>
```

1行目には、開始タグ`<h1>`と終了タグ`</h1>`があります。この部分全体が要素名`h1`の要素となります。この`h1`要素の内容は、「これは見出しのテキストのかたまりです」というテキストです。

2行目は開始タグ`<p>`と終了タグ`</p>`で囲まれ、`p`要素であることを
表しています。要素の内容は「これは本文です。」というテキストです。

3行目は少し複雑です。2行目と同じように`p`要素としてマークアップされていますが、この要素の中にはさらに`<mark>`と`</mark>`というタグがあります。`p`要素の内容に、テキストと`mark`要素が入っている形になります。

## 終了タグの省略

原則として、開始タグと終了タグはペアで存在しますが、HTML構文の場合、終了タグは省略できる場合があります。

ある要素の終了タグが省略できるかどうかのルールは、仕様の各要素の説明に記載されています。これまでに何度か出てきた`p`要素[^2]の場合は、以下のように記載されています。

[^2]: 4.4.1 The p element <https://html.spec.whatwg.org/multipage/grouping-content.html#the-p-element>

>Tag omission in text/html:
>A p element's end tag can be omitted if the p element is immediately followed by an address, article, aside, blockquote, details, div, dl, fieldset, figcaption, figure, footer, form, h1, h2, h3, h4, h5, h6, header, hgroup, hr, main,menu, nav, ol, p, pre, section, table, or ul element, or if there is no more content in the parent element and the parent element is an HTML element that is not an a, audio, del, ins, map, noscript, or video element, or an autonomous custom element.

親要素と直後の要素が一定の条件の場合に、終了タグを省略できることがわかります。具体的には、さきほどの例は以下のように省略できます。

```html
<p>これは本文です。
<p>この<mark>キーワード</mark>はこの文章で重要なものを表します。
```

省略された終了タグ`</p>`は、以下のようにブラウザーによって補われて解釈されます。

```html

<p>これは本文です。</p>
<p>この<mark>キーワード</mark>はこの文章で重要なものを表します。</p>
```

`p`要素のほかに終了タグが省略可能な要素としては、`li`要素、`dt`要素、`dd`要素、`tr`要素、`th`要素、`td`要素、`caption`要素、`thead`要素、`tbody`要素、`tfoot`要素、`option`要素、`rp`要素、`rt`要素などが挙げられます。

終了タグが省略できない要素についても見てみましょう。たとえば`mark`要素[^3]の場合、以下のように記載されています。

[^3]: 4.5.23 The mark element <https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-mark-element>

>Tag omission in text/html:
>Neither tag is omissible.

開始タグも終了タグも省略できないとあります。このように書かれている要素の場合、終了タグを必ず書かなくてはなりません。

### 終了タグを持たない要素

終了タグの省略が可能な要素が存在する一方で、そもそも終了タグを持たない要素もあります。以下は、`br`要素の使用例です。

```html
<p>詩などの<br>文章では<br>改行位置が<br>重要になることもあります。</p>
```

`br`要素は改行を指定する要素で、その位置で改行されることが期待さ
れます。タグ省略については、仕様に以下のように記載されています。

>Tag omission in text/html: No end tag.

終了タグを持たないとあります。このように、終了タグを持たない要素を「空要素（void element）」と呼びます。空要素はその性質上、常に内容が空になります。

### 開始タグの省略

要素によっては、終了タグだけでなく、開始タグも省略できる場合があります。具体的には、`html`要素、`head`要素、`body`要素、`tbody`要素が該当します。以下はタグを省略して記述した例です。

```html
<!DOCTYPE html> 
<title>test</title>
<table>
<tr><th>見出し1<td>データ1<tr><th>見出し2<td>データ2</table>
```

`html`要素、`head`要素、`body`要素、`tbody`要素の開始タグが書かれていません。しかし、このマークアップは構文エラーではなく、以下のように解釈されます。

```html
<!DOCTYPE html> 
<html> 
 <head> 
 <title>test</title> 
</head> 
<body> 
 <table> 
 <tbody> 
<tr> 
 <th>見出し1</th> 
 <td>データ1</td> 
</tr> 
<tr> 
 <th>見出し2</th> 
<td>データ2</td> 
</tr> 
</tbody> 
</table> 
</body> 
</html> 
```

上記では`html`要素、`head`要素、`body`要素、`tbody`要素を表すタグは一切書かれていませんでしたが、実際には要素が存在することになります。

### 要素の入れ子

ある要素の内部に別の要素が入っていることを「入れ子（nest）」といいます。ある要素の内部に別の要素を入れることを「入れ子にする」または「ネストする」といいます。

入れ子は多重にできます。以下の例では、`body`要素の中に`p`要素が入れ子になり、その中にさらに`mark`要素が入れ子になっています。 

```html

<body>
<p>この<mark>キーワード</mark>はこの文章で重要なものを表します。</p>
</body>
```

ある要素の中に入っている要素を、その要素の「子孫（descendant）」といいます。また、ある要素の直下にある要素を「子（child, children）」といいます。

逆に、ある要素のすぐ外側の要素を「親（parent）」、親の親なども含む外側の要素全般を「祖先（ancestor）」といいます。

上記の例では、`mark`要素は、`p`要素の子要素であり、子孫要素です。また、`body`要素の子孫要素でもあります。ただし、`body`要素の子要素ではありません。

なお、ある要素の子になれる要素は決まっています。たとえば、`p`要素の中に`mark`要素を入れることはできますが、`mark`要素の中に`p`要素を入れることはできません。詳しくはCHAPTER 2-4で説明します。

#### 誤った入れ子とエラー処理

要素は、複数の要素にまたがることはできません。たとえば、以下のようにマークアップしたとします。

```html
<p>ある<mark>長いキーワード</p>
<p>キーワードの続き</mark>はこの文章で重要なものを表します。</p>
```

このようなマークアップは、誤った入れ子であるため、不正なものとしてエラーになります。実際には、ブラウザーはこのようなエラーに出会うと、マークアップを以下のように修正して解釈します。

```html

<p>ある<mark>長いキーワード</mark></p>
<p>キーワードの続きはこの文章で重要なものを表します。</p>
```

エラー処理の方法は要素によって異なり、予想困難な挙動になることも
あります。CHAPTER 2-8の「終了タグを書き漏らした際のエラー」（P090）
も参照してください。 

## HTML文書とDOCTYPE

1つの文書全体をHTMLとしてマークアップしたものを「HTML文書（HTML document）」と呼びます。HTML文書を完成させるためには、文書の先頭に以下のように「DOCTYPE」と呼ばれるマークを書きます。大文字小文字は区別しないため、小文字で書くこともできます。 

```html
<!DOCTYPE html>
```

歴史的な理由により、ブラウザーは、DOCTYPEがないHTML文書を古いものとみなし、特殊な扱いをします。DOCTYPEを記述するのは、その処理を防ぐためで、それ以上の意味はありません。

## 最低限のHTML文書

ここまでの説明で、ひとまずHTML文書を作成する準備が整いました。以下は、タグを一切省略していない最低限のHTML文書のサンプルです。

```html
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"> 
<!DOCTYPE html system "about:legacy-compat"> 
HTML4の文書型宣言01SGMLの文書型宣言として妥当なDOCTYPE02HTMLのサンプル12<!DOCTYPE html> 
<html> 
<head> 
<title>最低限のHTML</title> 
</head> 
<body> 
<h1>最低限のHTML</h1> 
<p>これはHTML文書です！</p> 
</body> 
</html>
```

