# グローバル属性

HTMLの多くの要素は、個々の要素ごとに異なる独自の属性を持ちますが、属性の中には、複数のHTML要素に共通して利用できるものもあります。
中には、ほとんどすべての要素で共通して利用できる属性もあり、「グローバル属性」(Global attributes) と呼んでいます。ここでは、グローバル属性について説明します。

## グローバル属性とは

グローバル属性とは、ほとんどすべてのHTML要素に共通して利用できる属性です。HTML仕様では、きわめて多数のグローバル属性に言及されています。

グローバル属性の中には、HTML仕様では規定されていないものもあります。WAI-ARIAの仕様で規定されている`role`属性や`aria-*`属性、XMLの仕様で規定されている`xml:lang`や`xml:space`などが典型例です。

本書では、グローバル属性の中でも、HTML仕様で規定されているもの、かつ代表的と考えられるものに絞って紹介します。ここで紹介していないグローバル属性については、仕様を参照してください。

## `title`属性

`title`グローバル属性は、要素に対するヒント、助言の情報を表します。全ての要素に指定できますが、`link`や`abbr`など一部の要素では特別な意味を持つことがあります。詳細は`link`要素、`abbr`要素の項を参照してください。

属性値は任意のテキストで、要素に対するヒントや助言となり得る単語や文章を指定します。

<!-- a11y note -->
ウェブアクセシビリティの観点では、`title`属性の値はユーザーに伝わらない可能性があることに注意してください。

ほとんどのブラウザーでは、要素にマウスポインターを載せた時に`title`属性の値がツールチップとして表示されますが、マウスポインターの利用が必須となる場合がほとんどです。タッチスクリーンやキーボードの操作では、ツールチップを表示させることが不可能な場合があります。

スクリーンリーダーでは、状況によって、`title`属性の値を「アクセシブルな名前」 (accessible name) として利用することがあります。たとえば`img`要素の場合、`alt`属性があれば`alt`属性の値が読まれますが、`alt`属性がなく`title`属性がある場合、`title`属性の値が読まれる場合があります。`input`要素に`label`が結び付けられていない場合にも、同様に`title`属性の値が利用されることがあります。

ただし、`title`属性がどのように利用されるかは要素によっても、スクリーンリーダーの種類によっても異なります。スクリーンリーダーで読ませたいという意図であれば、`title`属性ではなく`aria-label`などのARIA属性の利用を検討した方がよいでしょう。
<!-- /a11y note -->


## `lang`属性

`lang`属性は、指定された要素の言語 (自然言語) を指定します。子孫要素がある場合には、子孫要素にも言語指定が継承されます。

属性値には、BCP47の「言語タグ」(language tag) を指定します。言語タグの詳細は、W3C文書「HTMLとXMLにおける言語タグ」[^1]を参照してください。

[^1]: <https://www.w3.org/International/articles/language-tags/>

日本語を表す言語タグとしては、`ja`もしくは`ja-JP`が利用されます。言語タグは「サブタグ」(subtag) を組み合わせて構成されており、`ja-JP`の場合には`ja`の部分が「言語」（language）サブタグ、`JP`の部分が「地域」（region）サブタグです。ほかによく見るものとして「用字」（script）サブタグがあり、中国語簡体字を表す`zh-Hans`の`Hans`の部分が該当します。<!--他にも、拡張言語、変種、拡張、私用などのサブタグが存在します。-->2つ以上のサブタグを使う場合、ハイフン`-`でつなぎます。

言語タグの例としては、以下のようなものがあります。

- `en` （英語）
- `zh` （中国語）
- `ryu` （沖縄方言）
- `zh-Hant` (繁体字)
- `ja-Hira` （ひらがな）
- `en-GB` （イギリス英語）
- `en-US` （アメリカ英語）
- `zh-Hant-HK` （香港で使われる、繁体字中国語）

用字サブタグや地域サブタグは必須ではありません。言語タグ`ja-JP`は「日本で話される日本語」を意味しますが、通常、これは単に「日本語」と言って指すものと変わらないはずです。必要のないサブタグは指定せず、単に`ja`とするほうが望ましいでしょう。

言語タグは慣習的に言語サブタグを小文字、地域サブタグを大文字で記述することがありますが、`lang`属性の値は大文字・小文字を区別しません。

要素に`lang`属性が指定されていない場合、親要素の言語指定を継承します。このため、`lang`属性を持たない要素であっても、祖先要素に`lang`属性があれば言語の指定が行われていることになります。CSSで特定要素の言語指定を取得したい場合は、`lang`属性の値を見るのではなく、`:lang`擬似クラスを利用してください。

祖先要素にも`lang`属性がない場合、WebページのHTTP応答ヘッダの`Content-Language`の値、`meta`要素で指定された値が参照されます。それらもない場合、言語指定は不明(unknown)となります。基本的には、`html`要素に`lang`属性を設定し、ページ全体の言語を適切に指定するべきです。

<!-- a11y note -->
`lang`属性の値には、主に以下のような用途があります。

- 言語によって適切なフォントやグリフを選択する (漢字を中国語のもの、日本語のものどちらにするかなど)
- 言語によって引用符を選択する (`q`要素の項目も参照してください)
- スクリーンリーダーの音声合成エンジンを選択する
- 翻訳機能を利用する際、翻訳元の言語を特定する

アクセシビリティ上は、特にスクリーンリーダーの音声合成エンジンに影響することが重要です。iOSのVoiceOverは`lang`属性を参照して音声合成エンジンを切り替えます。適切な言語設定が行われていないと、コンテンツを全く読まないこともあるため、言語設定が確実に行われるようにしてください。`html`要素に`lang`属性を設定し、ページ全体の言語を適切に指定しておくべきです。
<!-- /a11y note -->

### XML構文の場合

XML構文の場合、XMLの属性である`xml:lang`属性を使用することもできます。属性値の規則は`lang`属性と同じです。古いHTMLの慣習として、`xml:lang`と`lang`の両方を記述することもありますが、両方を記述する場合は、両者に異なる値を指定してはなりません (大文字・小文字のみの違いは許されます)。

## `style`属性

要素に`style`属性を指定すると、その要素に対してCSSスタイルを設定することができます。属性値にはCSSの「宣言」(declaration)を記述します。セミコロンで区切って複数の宣言を記述することもできます。指定できる値の詳細はW3C仕様の"CSS Style Attributes"[^2]を参照してください。

[^2]: <hhttps://drafts.csswg.org/css-style-attr/>

`style`属性で指定したスタイルは、原則としてその要素のみに適用されます (継承が行われるスタイルは、子孫要素に継承されます)。複数の要素に対してまとめてスタイルを指定したい場合には、`style`要素を使用するか、`link`要素で外部スタイルシートを参照する方がよいでしょう。

JavaScriptによる処理で特定要素の見た目を変更したい場合に、`style`属性の書き換えが行われることがあります。要素の表示・非表示を行うために`style`属性を書き換えるケースもありますが、現在のHTMLでは`hidden`属性を利用することもできます。単に非表示にしたいだけであれば、`hidden`属性を利用するほうが良いでしょう。

なお、`style`属性で指定した宣言の「詳細度」(specificity)は最高となり、他のあらゆるセレクタよりも優先されます。古いCSS仕様ではIDセレクタと同一の詳細度とされていたこともありましたが、現在では`style`属性が優先です。詳細はCSSの仕様[^3]を参照してください。

[^3]: CSS 2.2 の 6.4.3 Calculating a selector's specificity <https://www.w3.org/TR/CSS22/cascade.html#specificity>、および CSS Cascading and Inheritance Level 4 の 6.1. Cascade Sorting Order <https://www.w3.org/TR/css-cascade-4/#cascade-specificity> を参照。

<!-- a11y note -->
`style`属性を利用すると要素の見た目を変更することができますが、見た目の変更はスクリーンリーダーの利用者には伝わらないことがありますので注意が必要です。

`style`属性では原則として見た目が変化するだけですが、`display`プロパティの値を変更した場合、セマンティクスに影響を及ぼすことがあります。`display:none`を指定した場合、視覚だけでなく、スクリーンリーダーでも読まれなくなります。また、`table`関連の要素について`display`を`table`以外のものに変更すると、スクリーンリーダーによっては`table`として扱われなくなることがあります。
<!-- a11y note -->

## `class`属性

`class`属性を利用すると、要素が所属するクラス名を指定することができます。値はスペース区切りのトークンであり、複数の値をスペースで区切って指定することができます。

クラス名はセマンティクス上の特定の意味を持つものではなく、製作者が自由に命名して指定することができます。

### クラス名の用途
クラス名は主に以下のような用途に用いられます。

- CSSのスタイルを適用する
- JavaScriptで使用する
- メタデータとして利用する

最も多い利用法は、CSSのスタイルを適用するためのものでしょう。CSSでは、クラスセレクターを利用して特定のクラス名を持つ要素にスタイルを適用することができます。

```CSS
.global-footer__top {
    margin-top: 3em;
}
```

この用途では、クラス名の命名は開発者の自由です。ただし、無秩序に命名すると運用や管理が困難になる場合があります。スタイルを適用するためのクラス名の命名にはいくつもの流儀があり、さまざまな議論がありますので、参考にしてルールを整えるとよいでしょう。

JavaScriptから利用することも行われます。DOMの`getElementsByClassName()`メソッドで特定のクラス名を持つ要素を選択することができます (`getElementsByClassName()`の戻り値が`Array`ではなく`HtmlCollection`型のオブジェクトであることに注意してください)。

後述の`id`属性と異なり、複数の要素に同一のクラス名を指定することができるため、複数の要素に一括処理を行いたい場合に便利です。

```html
<button class="js-menu-button">menu</button>
<a class="js-menu-button">menu</a>
<script>
    const menuButtonsCollection = document.getElementsByClassName(`js-menu-button`);
    const menuButtonsArray = Array.from(menuButtonsCollection);
    menuButtonsArray.forEach(element => {
        // いい感じにメニューボタンの処理をする
    });
</script>
```

JavaScriptからクラス名を操作する場合、クラス名に`js-`というプレフィクスをつけるケースが見られます。これは仕様で規定されているものではなく、単なる慣習です。こうすることで、CSSで利用しているものとJavaScriptで操作するものとを明確に見分けられるようになります。

なお、`class`という単語が多くのプログラム言語で予約語となっている関係上、DOMでこの属性を参照する場合は`className`プロパティを利用します。一部のブラウザーでは、`setAttribute("class")`で`class`属性の値が変更できないこともあるので注意しましょう<!-- といってもIEだけか? -->。

クラス名をメタデータとして利用する方法もあります。「マイクロフォーマット」(Microformats)と呼ばれる仕様では、HTMLの`class`属性や`rel`属性などを利用して、その要素の意味を表すことができます。以下の例は、マイクロフォーマットの仕様の一つであるh-card[^4]の例です。

[^4]: <http://microformats.org/wiki/h-card>

```html
<div class="h-card">
  <a class="p-name u-url"
     href="https://blog.lizardwrangler.com/" 
    >Mitchell Baker</a> 
  (<a class="p-org h-card" 
      href="https://mozilla.org/"
     >Mozilla Foundation</a>)
</div>
```

`h-`や`p-`の接頭辞のつけられたものがマイクロフォーマットのクラス名です。この例では、ふたつの`a`要素とその内容が、それぞれ人名と織名を表すことがわかるようになっています。

なお、現在のHTMLでは、メタデータを表現するためにマイクロデータを利用することもできます。マイクロデータでは`class`属性は利用せず、`itemprop`などの専用の属性を利用します。詳しくは`meta`要素の項を参照してください。

<!-- a11y note -->
クラス名の命名は任意であり自由ですが、仕様では、コンテンツの見た目ではなく性質を表す名前を使うことが推奨されています。




ただし、性質によって名付けたからと言って、その性質がユーザーに伝わるわけではないことに注意してください。たとえば、`class=heading`と名付けても、その要素は見出しとして扱われるわけではありません。

要素の振る舞いを記述したい場合には、`class`ではなく`role`などのARIA属性を利用すると良いでしょう。ARIA属性に対してスタイル指定をすると、`class`の指定を省略できることもあります。以下は、特定のクラスに対して非表示のスタイルを適用している例です。

<!--お勧めしない例-->
```html
<style>
    .js-hidden{display: none;}
</style>
<div class="js-hidden">このコンテンツは非表示</div>
```

ARIA属性を利用すると以下のようにすることもできます。`aria-hidden=true`を指定した場合、スタイル指定がなくてもスクリーンリーダーに対して読み上げされないことに注意してください。

<!--ややお勧めの例-->
```html
<style>
    [aria-hidden="true"]{display: none;}
</style>
<div aria-hidden="true">このコンテンツは非表示</div>
```

この例の場合、単純にHTMLの`hidden`属性を使うこともできます。

```html
<div hidden>このコンテンツは非表示</div>
```


<!-- /a11y note -->

## `id`属性

文書内において唯一な識別子（ID）を設定します。1つの文書内でIDの値が存在してはなりません。

古いHTMLではIDの値に使用できる文字列に制限がありました。具体的には、ASCII英字、数字、`-`、`_`、`.`というものでした。現在のHTML仕様にそのような制限はありませんが、慣習として古いHTMLの文字列制限に従うことが多いです。

IDは次の方法で参照できます。

- URLのフラグメント
- CSSのIDセレクター
- DOMの`document.getElementById()`メソッド

IDを参照する属性
labelのforなど


## `tabindex` 属性

この属性は、要素が入力フォーカスを持つ場合に、キーボードの逐次ナビゲーション（通常は<kbd>Tab</kbd>キー）に加わるかどうか、加わるとすればどの順番かを指定します。

値として整数を受け付けます。負の数、`0`、正の数によって、挙動は変化します。

- 負の数（通常は`-1`）の場合、要素はフォーカス可能ですが、キーボードの順次ナビゲーションでは到達しないことを示します。
- `0`の場合、要素をクリックでもキーボードでもフォーカス可能にしたいことを示します。
- 正の数の場合、`0`と同じでかつ、数字が相対的な順序を示します。ウェブアクセシビリティの観点から、正の数を指定することは勧められません。DOMの順序とフォーカス順序が一致するようにHTMLを記述することが望まれます。


## イベントハンドラーコンテンツ属性

イベントハンドラーコンテンツ属性、または単にイベントハンドラー属性は、例えば`onclick`のような、`on`で始まり、その直後にイベントの名前が続く属性です。仕様ではとして60以上の属性がグローバル属性のセクションに列挙されています。グローバル属性としてどのようなイベントハンドラー属性が存在するのかは仕様を参照ください。

イベントは、キーボードやマウス、フォーカスやページの読み込みなど多岐にわたります。どのような種類にどのような具体的なイベントが存在するのかについては、MDNのイベントリファレンスが参考になります[^6]。

イベントハンドラーとよく似た概念に、イベントリスナーがあります。通常同じ処理結果が得られますが、JavaScriptを記述するにあたっては、イベントリスナーを使用するのが一般的です。イベントハンドラーとイベントリスナーの例をそれぞれ示します。例示コードで得られる結果は同一です。

```
<p><button onclick="return myFunc()">押します</button></p>

<script>
function myFunc() {
    window.alert("Hello World!");
}
</script>
```

```
<p><button id="sample1">押します</button></p>

<script>
function myFunc() {
    window.alert("Hello World!");
}
let e = document.getElementById('sample1');
e.addEventListener('click', myFunc, false);
</script>
```

[^6]: イベントリファレンス | MDN https://developer.mozilla.org/ja/docs/Web/Events

## その他のグローバル属性

詳細な説明はしないものの、HTMLコードを見ていると出くわす可能性があるものの一部を簡単に紹介します。

- `accesskey`属性。要素のショートカットキーのヒントを示します。OSやブラウザーが持つショートカットキーと衝突することがあるなどの理由から、使用は推奨されません。
- `hidden`属性。要素が現在のページの状態に直接関係がないことを示します。この属性が指定されると、ブラウザーは要素をレンダリングしません。
- `itemid` / `itemprop` / `itemref` / `itemscope` / `itemtype` 属性。HTMLコンテンツにメタデータを記述できるmicrodata（マイクロデータ）のための属性です。
- `translate`属性。翻訳対象とするかどうかを示します。機械翻訳サービスがこの属性を尊重することがあります。
- ARIA `role`および`aria-*`属性。WAI-ARIA仕様に基づいて、追加のセマンティックスを指定するために使用します。WAI-ARIAについては4-2節を参照ください。
- `xmlns`属性。XML名前空間を記述するための属性です。古いHTMLの仕様の中には、記述を求められることがありました。`text/html`では何の効力もありません。





## `data-*`属性
カスタムデータ属性と呼ばれるこの属性は、ウェブ制作者が自由に属性の名前を設定できるものです。`*`は、命名規則に従った自由な文字列を意味します。命名規則に沿ったものであれば、どのような名前であっても構いませんが、概ね次の規則になっています（正確な規則は仕様を参照ください）。

- 文字は、記号類でない文字のほぼすべてです。数字、アルファベット、ひらがなや漢字を含むマルチバイト文字を含めることができます。ただし、アルファベットの大文字`A`から`Z`を使用することはできません。使いやすさのため、アルファベットの小文字のみを使うことがほとんどです。
- 記号類は、ハイフン`-`、アンダースコア`_`を使うことができます。
- 開始してよい文字に制約があります。文字列`xml-`で始めてなりません。また、数字やハイフンで始めてもいけません。

たとえば、次のようなコードでカスタムデータ属性の属性値を取得することができます。JavaScriptのプロパティで属性値を取得するとき、先頭の`data-`を除去したプロパティ名となります。`*`にハイフンを含む場合、名前はキャメルケースで取得します（つまり、ハイフンの次の文字を大文字にしてハイフンを除去します）。

```
<span id="cdtest" 
data-htmlbook-test="これはテストコードです。" 
data-htmkbook_test="もしもし">深い意味はありません</a>
<script>
var e = document.getElementById('cdtest');
window.alert(e.dataset.htmlbookTest);
</script>
```















## コラム: 仕様で言及されているグローバル属性の一覧

2021年7月時点にて、仕様の"3.2.6 Global attributes"で言及されている属性は以下の89種類です。うち64種類がイベントハンドラ属性で、これを除くと25種類ということになります。

accesskey
autocapitalize
autofocus
contenteditable
dir
draggable
enterkeyhint
hidden
inputmode
is
itemid
itemprop
itemref
itemscope
itemtype
lang
nonce
spellcheck
style
tabindex
title
translate
class
id
slot
onauxclick
onblur
oncancel
oncanplay
oncanplaythrough
onchange
onclick
onclose
oncontextmenu
oncopy
oncuechange
oncut
ondblclick
ondrag
ondragend
ondragenter
ondragleave
ondragover
ondragstart
ondrop
ondurationchange
onemptied
onended
onerror
onfocus
onformdata
oninput
oninvalid
onkeydown
onkeypress
onkeyup
onload
onloadeddata
onloadedmetadata
onloadstart
onmousedown
onmouseenter
onmouseleave
onmousemove
onmouseout
onmouseover
onmouseup
onpaste
onpause
onplay
onplaying
onprogress
onratechange
onreset
onresize
onscroll
onsecuritypolicyviolation
onseeked
onseeking
onselect
onslotchange
onstalled
onsubmit
onsuspend
ontimeupdate
ontoggle
onvolumechange
onwaiting
onwheel

これらに加えて、HTML仕様で規定されていないものとしてWAI-ARIAの`role`属性や`aria-*`属性が存在します。XML構文の場合には`xml:lang`や`xml:spce`などXMLの仕様で規定されている属性も利用できます。