<!-- ch4-2.txt (8ページ、3000～4600字x2想定) -->

# WAI-ARIA

HTMLで利用できる属性の中には、HTML仕様とはべつの文書で定義されているものもあります。近年よく利用されるもののひとつに、WAI-ARIAがあります。ここでは、ウェブサイトやウェブアプリケーションのウェブアクセシビリティの向上に寄与するWAI-ARIAという技術と、行く使われるいくつかの属性について説明します。

## WAI-ARIAの概説

WAI-ARIA[^1]とは、W3Cによって発行されている仕様の名称で、単にARIAとも呼ばれます。

[^1]: https://www.w3.org/TR/wai-aria/

WAIはWeb Accessibility Initiativeの略称で[^2]、W3C内部に存在するウェブアクセシビリティを推進する組織です[^3]。ARIAとは、Accessible Rich Internet Applicationsの略称です。ここでの "Rich" は、表現が豊かであるという意味ですが、端的にはクライアント側で動的な処理を行うことを指します。

[^2]: WAIの発音は「ワイ」であったり「ウェイ」であったりと、英語圏でも一定ではないようです。

[^3]: https://www.w3.org/WAI/

かつてのウェブアプリケーションは、静的HTMLのフォームからデータを送信してサーバー側で処理することが一般的でした。その後、ブラウザーの表現力の向上に伴い、動的に変化するコンテンツや、複雑なユーザーインターフェイスを実現できるようになりました。これらは、従来のものより豊かな表現であるという意味で「リッチアプリケーション」と呼ばれました。

このようなリッチなアプリケーションは、しばしばアクセシビリティ上の問題を抱えることがあります。HTMLが元々用意しているフォームコントロールと異なり、リッチなインターフェイスは、スクリーンリーダーなどの支援技術を使っているユーザーに対して、十分な情報を提供できない場合があります。それを補うために作られたのがWAI-ARIAです。

WAI-ARIAは単独で使うものではなく、別のマークアッブ言語と組み合わせ、それを補助する形で利用します。組み合わせるマークアップ言語のことを「ホスト言語」(host language)と呼びます。ホスト言語はHTML以外にもあり、たとえばSVGがホスト言語になることもあります。とはいえ、ウェブにおいては、HTMLがホスト言語になることがほとんどです。

### ARIA属性

WAI-ARIAは、ホスト言語の要素に対して追加で指定できる属性を定義します。WAI-ARIAが定義する属性を「WAI-ARIA属性」(WAI-ARIA attribute)、もしくは単に「ARIA属性」(ARIA attribute)と呼びます。ARIA属性を利用すると、ホスト言語の要素に対して追加の情報を与えることができます。

ARIA属性は、その性質によって「ロール」(role)、「プロパティ」(property)、「ステート」(state)の3種類に分類されます。

#### ロール

ロールとは要素の役割を表すもので、この要素が何であるのか、何をするものかという情報を与えます。要素にロールを定義する際は、`role`属性を使用します。

たとえば、`div`要素に`role="navigation"`を指定すると、HTMLの`nav`要素と同じようなナビゲーションのセマンティクスを持つことを示せます。ロールの中には、`role="search"`のように、HTMLの要素だけでは表現できないものもあります。

#### プロパティ

プロパティは、要素に対し、性質や特性などの情報を表現するものです。要素のプロパティを定義するARIA属性には、`aria-`で始まる名前がつけられています。

たとえば、`aria-required="true"`は、指定されたフォームの要素が必須であることを伝えます（HTMLの`required`属性と同じセマンティクスを持ちます）。`aria-label`属性のように、要素に対して追加の説明を与えるものや、`aria-controls`属性のように、他の要素との関連性を示すものもあります。

#### ステート

ステートは、要素の現在の状態を表すものです。ステートを定義するARIA属性にも、`aria-`で始まる名前がつけられています。プロパティとステートの役割はほとんど同じですが、ステートは主に頻繁に変化することが想定されるものを表します。主にJavaScriptからの操作によって設定・変更され、現時点でのその要素の状態を表します。

たとえば、`aria-disabled="true"`は、指定された要素が現在無効になっていることを伝えますし、`aria-expanded`属性は、指定された要素と関連する要素が開・閉どちらの状態になっているのかを伝えます。

プロパティとステートの違いはそこまで厳密なものではありません。プロパティが頻繁に変更されたり、ステートが変更されずに使われることもあります。たとえば、`aria-valuenow`プロパティは範囲を示すコントロールの現在値を示すもので、頻繁に変化する可能性があります。`aria-hidden`ステートは要素を支援技術から隠すものですが、頻繁には変更されないような使われ方が主流です。

<!--プロパティとステートの中には特定のロールの要素に対してしか指定できないものがある、を書くか?最後まで見てから決める-->

### WAI-ARIAの周辺仕様

WAI-ARIAには、本体の仕様のほかに複数の関連文書があります。WAI-ARIAを体系立てて理解したい場合や、HTML仕様との対応関係を調べたい場合などは、関連文書を参照する必要があります。

#### WAI-ARIA仕様

WAI-ARIA仕様の本体では、WAI-ARIAそのものの説明と、ロール、プロパティ、ステートの定義を行っています。それぞれの意味や効果、どのロールにどのプロパティやステートが指定可能か、といった情報も含まれています。

JavaScriptからARIA属性にアクセスする際に利用するIDLインターフェイスについても、WAI-ARIA 1.2以降、この仕様本体で定義されるようになりました。

ロールの情報の中には、"Related Concepts"として、どのHTML要素に対応する概念かという情報もあります。ただし、これは厳密なものではありません。HTML要素とロールとの正確な対応関係を見たい場合は、後述のARIA in HTMLを参照する必要があります。

<!-- 参考日本語訳紹介する? -->

#### ARIA in HTML

ARIA in HTML[^4]は、HTMLをホスト言語とした場合のARIAの位置付けを規定した文書です。ARIAロールとHTMLの要素との対応関係や、どのHTML要素にどのロールを指定できるかといった情報があります。

[^4]: https://www.w3.org/TR/html-aria/

WAI-ARIA、ARIA in HTML、そしてHTML仕様の関係性は以下の図のようになります。

<!-- この図いります? -->
![WAI-ARIA、ARIA in HTML、HTMLの関係図](../img/4-2-01.png)
図 4-2-1 WAI-ARIA、ARIA in HTML、HTMLの関係

ARIA in HTMLはHTMLとARIAとの組み合わせのルールを規定しているだけで、具体的な使い方までは説明していません。使い方のガイドとしては、後述のUsing ARIAがあります。

#### Using ARIA

Using ARIA[^11]はW3Cのワーキンググループノートで、ARIAの基本的な使い方の方針について書かれています。入門ガイドのような位置付けだと考えるとよいでしょう。

[^11]: https://www.w3.org/TR/using-aria/

Using ARIAには使用例も出ていますが、コード例はあくまで簡単なものにとどまりますので、本格的なウィジェットをデザインするには不十分かもしれません。本格的なコード例はまた別の文書にまとめられています。

#### WAI-ARIA Authoring Practices

WAI-ARIA Authoring Practices[^5]はW3Cのワーキンググループノートで、カルーセルやモーダルダイアログといった本格的なウィジェットの実装例が紹介されています。コード例はもちろん、実際に動作を見ることのできるサンプルも用意されており、実際に制作する際の参考になるでしょう。

[^5]: https://www.w3.org/TR/wai-aria-practices/

<!-- 参考日本語訳紹介する? -->

#### その他の関連文書

その他、WAI-ARIAの関連文書には以下のようなものがあり、WAI-ARIAスイートとして位置づけられています。

- Core Accessibility API Mappings[^6] : ブラウザーや支援技術の開発者向けの仕様
- HTML Accessibility API Mappings[^7] : プラットフォームAPIとの対応を示した仕様
- Accessible Name and Description Computation[^8]というアクセシブルな名前や説明などの優先順位を決める仕様

[^6]: https://www.w3.org/TR/core-aam/

[^7]: https://www.w3.org/TR/html-aam/

[^8]: https://www.w3.org/TR/accname/

さらに、WAI-ARIA仕様の拡張として、EPUBのためのDPUB-ARIA[^9]、SVGのためのSVG Accessibility API Mappings[^10]という仕様もあります。

[^9]: Digital Publishing WAI-ARIA Module https://www.w3.org/TR/dpub-aria/

[^10]: https://www.w3.org/TR/svg-aam/


## `role`属性

`role`属性を使用すると、要素のロールを指定することができます。

属性値としてロールの名前を指定しますが、複数のロールをスペースで区切って列挙することもできます。複数を指定した場合、同時に適用されるわけではなく、ブラウザーが理解でき、かつ、その要素に適用可能なロールのうち、先頭にあるものが適用されます。

以下は複数指定の例です。

```html
<div role="dummyrole blockquote note">
???
</div>
```

この場合、`dummyrole`というロールは現在のARIA仕様に存在しないため、無視されます。`blockquote`
ロールはARIA 1.2で定義されたロールで、ARIA 1.2に対応するブラウザーはこれを採用するでしょう。そうでないブラウザーはこれも無視して`note`ロールを採用することになります。

`role`属性を使用する際には、さまざまな注意点があります。

### 抽象ロールは指定できない

ARIA仕様では、ロールを継承・派生関係で定義しているため、「抽象ロール」(abstract role)が存在します。これはロールの派生関係を表現するために定義されているもので、実際に使うことはできません。逆に、実際に使える具体的なロールは「具象ロール」(concrete role)と呼びます。

`role`属性で抽象ロールを指定することはできません。抽象ロールを指定していても、ブラウザーはそれを無視します。たとえば、`window`ロールは抽象ロールですので、以下のような指定はできません。

<!-- 意図どおりに動作しない例 -->
```html
<div role="window">
ダイアログのつもり?
</div>
```

`window`ロールの派生ロールである`dialog`は具象ロールですので、問題なく指定可能です。

<!-- 問題ない例 -->
```html
<div role="dialog">
ダイアログのつもり
</div>
```

あるロールが抽象ロールかどうかは、ARIA仕様本体を見ることで確認できます。以下に挙げる12種のロールが抽象ロールとなっています。

<!-- 継承関係を階層で表現してみたが不要かも -->
- roletype
    - structure
        - range
        - section
            - landmark
        - sectionhead
    - widget
        - command
        - composite
            - select
        - input
    - window

### ネイティブロールの上書き

`role`属性はホスト言語にセマンティクスの情報を追加しますが、本書で説明してきたように、HTMLの要素の多くは、もともとセマンティクスを持っています。たとえば、`h1`要素はランク1の見出しを、`main`要素は主要なコンテンツを表します。`role`で明示的にロールを指定しなくても、その要素が暗黙的にロールを持っていることがあるのです。

このような、ホスト言語がもともと持つロールを「暗黙のネイティブロール」(implicit native role)、もしくは単に「ネイティブロール」(native role)と呼びます。どの要素がどのようなネイティブロールを持つかは、先に紹介したARIA in HTMLで定義されています。

要素が暗黙ネイティブロールを持つ場合、`role`属性で異なるロールを指定すると、ネイティブロールを上書きします。以下は、`a`要素に`role`属性を指定した例です。

<!-- 適切な例 -->
```html
<a href="/register" role="button">今すぐ登録</a>
```

`a`要素が`href`属性を持つ場合、ネイティブロールとして"link"を持ちますが、`role`属性によって"button"ロールが上書きされています。そのため、支援技術は、この要素をリンクではなくボタンとして認識します。たとえば、スクリーンリーダーは「今すぐ登録 リンク」ではなく「今すぐ登録 ボタン」と読み上げるようになります。<!-- 本当か? 要スクリーンリーダー検証 -->

なお、`role`属性はセマンティクスを上書きするだけで、機能は変更しないことに注意してください。上記の例は単に「ボタン」と読まれるだけで、`button`要素の持つ機能までは得られません。たとえば、スペースキーでボタンを押せるようにはなりません。

### 指定できるロールの制限

`role`属性では要素のネイティブロールを上書きできますが、ネイティブロールの機能と矛盾するような指定はできません。以下は適切でない例です。

<!-- 適切でない例 -->
```html
<button role="heading">見出し?</button>
```
<!--
Nu HTML Checkerは以下のようなエラーを出す
>Error: Bad value heading for attribute role on element button.
-->
`button`要素をボタンではなく見出しにしようとしていますが、ボタンと見出しとでは、持つ機能がかけ離れており、互換性がありません。このような無理のあるロール変更はできず、文法エラーとなります。
<!--
文法エラーになるのだが、現実のブラウザの挙動としては、普通にボタンの機能が残り、かつrole=headingも適用する。押せるのだが支援技術にはボタンではなく見出しと通知される要素が出来上がる。
Chrome/firefoxで確認。
-->
ARIA in HTMLでは、どの要素にどのロールが適用可能か定義されています。`button`要素に適用可能なロールは以下の通りです。

>checkbox, link, menuitem, menuitemcheckbox, menuitemradio, option, radio, switch or tab.

`heading`は含まれていないため、`button`要素のロールを`heading`にすることはできません。なお、見出しをボタンとして押せるようにしたい場合には、次のように、見出しの中にボタンを入れるとよいでしょう。

<!-- 望ましい例 -->
```html
<h1><button>見出しボタン</button></h1>
<!-- 見出し要素の内部にボタン要素を設置している -->
```

ARIA in HTMLで許されている組み合わせであっても、不用意なセマンティクスの変更は望ましくありません。以下の例は許されており、文法エラーにはなりませんが、望ましくない例です。

<!-- 望ましくない例 -->
```html
<div role="tablist">
<h2 role="tab">見出しタブ</h2>
</div>
```

この例では`h2`要素のロールを変更しているため、見出しであることが伝わらなくなります。この場合は以下のようにするとよいでしょう。

<!-- 望ましい例 -->
```html
<div role="tablist">
<div role="tab"><h2>見出しタブ</h2></div>
</div>
```

### 冗長なロール指定

ネイティブロールと全く同じロールを`role`属性で明示的に指定することも可能ですが、望ましくはありません。

<!-- 望ましくない例 -->
```html
<main role="main">
<h1 role="heading" aria-level="1">メインコンテンツ</h1>
...
</main>
```

これは文法エラーにはなりませんが、冗長です。ARIAの機能と全く同一の機能がネイティブで利用できる場合は、ネイティブの機能だけを使用し、ARIAを使わないようにすることが推奨されています。


### ロールの削除: `presentation`と`none`

時には、ホスト言語のネイティブロールを変更するのではなく、削除したい場合もあります。その際に使用するのが`presentation`ロールと`none`ロールです。これらはセマンティクスを持たないことを意味するロールであり、ネイティブロールを消し去る働きをします。

ネイティブロールを消したいケースには、たとえば以下のようなものがあります。

- `img`要素を純粋にレイアウト調整に用いている場合（いわゆるスペーサー画像）
- CSSの表示のフックのためだけに要素を用いている場合
- `table`要素を純粋にレイアウト調整のためだけに用いている場合（いわゆるテーブルレイアウト、CSSのブラウザーサポートが貧弱だった時代に、`table`要素を用いてページレイアウトを実現する手法）

以下は、スペーサー画像の意味を打ち消している例です。

```html
<!-- 純粋に装飾的であることをARIAロールで補強 -->
<img alt="" src="spacer.png" role="presentation none">
```

`img`要素にロール`presentation`や`none`を指定する場合、意味のある代替テキストを指定するべきではありません (言い換えると、`alt=""`を指定するべきです)。逆に言うと、意味のある代替テキストを指定する必要があるような画像の場合には、その画像に意味があるのですから、`presentation`や`none`を指定するべきではありません。

画像に限らず、意味のある要素や、ARIA属性でセマンティクスが与えられている要素に対しては、`presentation`や`none`を指定するべきではありません。後述の「ロールの削除ができない場合」も参照してください。

#### ロールの削除ができない場合

ロールの削除ができない場合もあります。まず、フォーカス可能要素やインタラクティブ要素のロールを消すことはできません。これは、要素が操作可能であることを担保するための決まりです。以下は`role`属性が機能しない例です。

<!-- 機能しない例 -->
```html
<button role="presentation">ボタンじゃない?</button>
```

この場合、ブラウザーは`role`属性を無視しなければならないと定められています。ロールの指定は無視され、ネイティブロールである"button"ロールが有効になります。
<!--
If an element is focusable, or otherwise interactive, user agents MUST ignore the presentation role and expose the element with its implicit role, in order to ensure that the element is operable.
-->

また、グローバルARIA属性が明示的に指定されている場合、その要素のロールは削除できません。以下は`aria-describedby`属性が指定されている例です。

<!-- 機能しない例 -->
```html
<section role="presentation" aria-describedby="heading01">
<h1 id="heading01">このセクションの説明</h1>
</section>
```

この場合、要素のロールは削除できませんので、`role="presentation"`の指定は無視され、ネイティブロールがそのまま残ります。

グローバルARIA属性が指定されていることが要件のため、たとえば`aria-hidden=false`のような一見無意味な指定でも、ロールは消せなくなります。

<!-- 機能しない例 -->
```html
<section role="presentation" aria-hidden="false">
<h1 id="heading01">このセクションの説明</h1>
</section>
```

この場合も、ブラウザーは`role`の指定を無視します。

なお、グローバルでないARIA属性がついている場合は、ロールの削除が可能です。以下は`aria-level`属性を使用している例です。

<!-- 機能する例 -->
```html
<h1 role="presentation" aria-level="1">このセクションの説明</h1>
```

この場合、`role=presentation`の指定は有効になり、ロールを削除できます。`aria-level`は`heading`ロールに対してのみ指定できる属性であり、グローバル属性ではないためです。

#### コラム: `presentation`ロールの誤解と`none`ロール

`presentation`ロールの働きはよく誤解されます。これは単にネイティブのセマンティクスを削除するもので、簡単に言えば、その要素を`div`や`span`に変更するのと同じ効果です。

よくある誤解は、このロールが要素の内容を削除したり、支援技術から隠すというものです。支援技術から要素を隠す`aria-hidden=true`と同じ効果があるかのように思われることがあります。

"presentation"という言葉は、「視覚効果のためだけのもの」という意味に受け取れます。視覚効果のためだけのもの、と言えば`alt=""`を指定した画像を連想する方も多いでしょう。それと同じように、このロールは支援技術からは完全に無視されると思われるのも無理はないかもしれません。

このような誤解を避けるために、ARIA 1.1では`role="none"`が新たに追加されました。`none`ロールは`presentation`ロールの別名であり、同じ効果を持ちます。`none`が十分にサポートされない間は、`role="none presentation"`と同時に指定することが勧められます。

### 必須所有要素がある場合のロール変更

HTMLの要素には、`table`や`ul`のように、必ず特定の子孫とセットで用いるものがあります。このような場合に必須となる特定の子孫を、ARIA仕様では「必須所有要素」(Required Owned Elements)と呼んでいます。`table`要素なら`tr`要素が、`ul`要素なら`li`要素が必須所有要素となります。
<!-- 
Required Owned Elementsの日本語訳要確認。
https://momdo.github.io/wai-aria-1.2/#mustContain では「必要とされる所有される要素」となっているが、これはどうなの……
いったん「必須所有要素」とした
-->
必須所有要素を持つ親要素のロールを変更した場合、ブラウザーは必須所有要素のロールを自動的に変更したり、削除したりすることがあります。

以下の例は、テーブルレイアウトでカラムを左右に並べたものです。

```html
<table>
<tr>
<td>左カラム</td>
<td>右カラム</td>
<tr>
</table>
```

このとき、ネイティブのロールとして、`table`要素は`table`ロール、`td`要素は`cell`ロールを持ちます[^1]。

[^1]: ブラウザーによっては、`table`に`th`や`caption`などが一切使われていない場合、レイアウト目的のテーブルと判断して独自のロールを割り当てることもあります。

このままでは支援技術に表として扱われてしまい、混乱を招くことがあります。そこで、`table`要素に`presentation`や`none`を指定し、表としてのセマンティクスを打ち消します。

```html
<table role="presentation none">
<tr>
<td>左カラム</td>
<td>右カラム</td>
<tr>
</table>
```

このとき、`td`のロールはどうなるでしょうか。`cell`ロールは祖先が`table`であることを前提としていますが、`table`ロールが失われたことにより、宙に浮いてしまうことになります。

このようなとき、ブラウザーは、`td`のセマンティクスを自動的に変更することがあります。ARIA 1.2仕様では、このような場合に割り当てるための`generic`ロールが定義されており、上記の例では`tr`要素や`td`要素のロールが`generic`に変更されます。

## その他のARIA属性

ARIA属性の多くは、本格的なアプリケーションを作る際、特に独自のウィジェットを作る際に役立つものです。しかし、中には一般的なウェブサイトで活用できるものもあります。ここでは、ARIA属性の中でもよく利用されるものを紹介します。ここで挙げていないARIA属性を駆使については、先に紹介した仕様を参照してください。

### `aria-hidden`ステート属性

`aria-hidden`はステートを表す属性で、その要素がアクセシビリティAPIに対して公開されるかどうかを指定します。属性値として"true"もしくは"false"を指定します。HTMLの真偽値属性とは指定の仕方が異なり、`aria-hidden`と書いただけでは効果を発揮しないので注意してください。

`aria-hidden=true`を指定すると、アクセシビリティAPIに公開されなくなります。言い換えると、支援技術から要素を隠すことができます。しかし、視覚環境での表示には影響しません。要素は視覚環境では表示され、しかしスクリーンリーダーでは読まれなくなります。

これは主に、冗長な情報を支援技術から隠すために使用します。たとえば、意味を持たないアイコンを表現するためにアイコンフォントを利用するような時、スクリーンリーダーでは意図しない読み上げがなされてしまうことがあります。`aria-hidden=true`を指定することで、読みあげられないようにすることができます。

```html
<span class="icon" aria-hidden="true">□</span>
```

要素が意味を持つ場合、`aria-hidden=true`を指定すると意味が伝わらなくなることに注意してください。意味のある要素の読まれ方を調整したい場合には、後述の`aria-label`などを使用します。

また、フォーカス可能な要素に`aria-hidden="true"`を指定した場合、フォーカスが行方不明になる危険性があります。後述のARIAのルール4を参照してください。

### `aria-label`プロパティ属性

`aria-label`プロパティ属性は、要素に対してラベル付けする文字列を定義します。HTMLの`title`属性に似たコンセプトを持ちますが、`title`属性と異なり、ブラウザーはツールチップ表示をしません。

主にアイコンボタンやアイコン画像など、視覚的には意味を持ち、かつテキストを持たない要素にラベルを与えるために使用します。以下の例は、閉じるボタンに「X」とだけ記載されている例です。

```html
<button type="button" aria-label="閉じる" onclick="myDialog.close()">X</button>
```

視覚環境ではこの「X」がバツ印のように見え、閉じるボタンであることが伝わりますが、スクリーンリーダーでは単に「エックス ボタン」などと読まれてしまいます。`aria-label`属性によって「閉じる」というラベルを与えることで、「閉じる ボタン」と読まれることが期待されます。

このとき、ボタンの内容である「X」というテキストが読まれなくなっていることにも注意してください。元々ラベルを持っている要素に`aria-label`属性でラベルを与えた場合、元のラベルは上書きされる形になります。

視覚環境ではこのラベルが伝わらないことに注意してください。この属性は、可視のテキストラベルがなくても伝わるケースで使用するべきです。視覚環境でもラベルが必要になる場合は、画面上に可視のテキストを置いた上で、後述の`aria-labelledby`属性を用いるべきです。

### `aria-labelledby`プロパティ属性

`aria-labelledby`属性を利用すると、その要素にラベルを与えることができます。`aria-label`と同様の働きをしますが、ラベルの文字列を直接指定するのではなく、ラベルを含む要素のIDを指定する点が異なります。視覚環境でも見えているラベルがある場合に、そのラベルを要素に結びつけることができます。HTMLの`label`要素の`for`属性と似ていますが、`label`要素とは参照の方向が逆になることに注意してください。

属性値は要素のID(`id`属性の値)です。IDを複数指定することもでき、その場合はスペースで区切ります。複数指定されている場合、その全てが有効となり、順に読まれます。次のコード例のように、2つ以上の要素を連結させることもできます。

```html
<div id="billing">請求書</div>
<div>
    <div id="name">名前</div>
    <input type="text" aria-labelledby="billing name"/>
</div>
<div>
    <div id="address">住所</div>
    <input type="text" aria-labelledby="billing address"/>
</div>
```

1つ目の`input`要素は「請求書 名前」、2つ目の`input`要素は「請求書 住所」とラベル付けされます。

`aria-label`属性と同様に、元あったラベルが上書きされることに注意してください。以下は、ラベルを持つボタンに` aria-labelledby`を指定した例です。

<!-- 望ましくなさそうな例 -->
```html
<div id="billing">請求書</div>
<button aria-labelledby="billing">
下書き保存する
</button>
```

この例の場合、「請求書 ボタン」とだけ読まれ、「下書き保存する」は読まれません。ボタンのラベルも読ませたい場合は、自身にIDをつけて参照することもできます。

```html
<div id="billing">請求書</div>
<button id="submitbutton" aria-labelledby="billing submitbutton">
下書き保存する
</button>
```

こうすると、「請求書 下書き保存する 送信ボタン」と読まれることが期待されます。

`aria-labelledby`では不可視の要素を参照することもできるため、不可視の要素を利用して細かい調整をすることも可能です。

```html
<div id="billing">請求書</div>
<span id="billingsubname" hidden>を</span>
<button id="submitbutton" aria-labelledby="billing billingsubname submitbutton">
下書き保存する
</button>
```

こうすると不可視の`span`の内容も参照されて「請求書 を 下書き保存する」というラベルになります。もっとも、実際にはここまで細かくこだわらなくてもユーザーには十分伝わるでしょう。

なお、ラベル全体を不可視にしたい場合は、`aria-labelledby`ではなく`aria-label`属性を使うべきです。

`aria-labelledby`と`aria-label`を同時に指定した場合は、`aria-labelledby`だけが有効となり、`aria-label`は無視されます。複数の方法でラベルを指定した場合の優先順位については、後述の「アクセシブルな名前」の項目を参照してください。

### `aria-describedby`プロパティ属性

`aria-describedby`属性を利用すると、その要素と説明文とを結びつけることができます。

使い方は`aria-labelledby`とほとんど同じです。要素のIDを指定すること、複数指定が可能であることも共通です。参照した要素がラベルではなく説明文として扱われる点が異なります。

```html
<label>新しいパスワード
<input type="password" aria-describedby="new-pass-desc">
</label>
<p id="new-pass-desc">※半角英数記号、8文字以上512文字以下で入力してください</p>
```

多くのスクリーンリーダーは、入力欄の種類とラベルを読んだ後に説明文を読み上げます。上記の例は、たとえば「新しいパスワード パスワード入力欄 半角英数記号、8文字以上512文字以下で入力してください」などと読まれます。

なお、要素の参照ではなく説明文のテキストを直接指定する`aria-description`属性は、ARIA 1.2には存在していません (ARIA 1.3のエディターズドラフト文書には含まれています)。ほとんどの場合、要素の説明文は視覚環境でも有益なものであり、視覚環境から隠す必要性は少ないでしょう。

### `aria-current`属性

`aria-current`属性を指定すると、その要素が「現在の項目」(current item)であることを示すことができます。ページナビゲーション、ステップナビゲーション、パンくずリストなどで現在位置を示したり、カレンダーの中で今日の日付を示すのに使えます。

属性値として"true"と"false"を指定できますが、その他に、現在地の種類を示すトークンを指定することもできます。指定できるのは以下の5種類です。

- page : 「現在のページ」であることを示します。
- step : 「現在のステップ」であることを示します。
- location : 「現在の位置」であることを示します。
- date : 「現在の日付」であることを示します。
- time : 「現在の時間」であることを示します。

以下はページナビゲーションに`aria-current`属性を指定した例です。

```html
<ul>
<li><a href="../1">1</li>
<li><a href="../2">2</a></li>
<li aria-current="page">3</li>
</ul>
```

このようにすると、3番目の項目では「3 現在のページ」と読まれることが期待されます。

なお、フォームコントロールやタブのようなコントロールで現在選択されている項目を表す場合は、`aria-current`ではなく`aria-selected`を使ってください。

```html
<div role="tablist">
<button role="tab"
 aria-selected="true"
 aria-controls="tabpanel01">タブ1</button>
<button role="tab"
 aria-selected="false"
 aria-controls="tabpanel02">タブ2</button>
</div>
```

### `aria-haspopup`プロパティ属性

`aria-haspopup`属性を指定すると、指定した要素がポップアップする何かを持っていることを示せます。典型的には、ポップアップメニューやダイアログボックスを表示するボタンなどに使用します。

ポップアッフプメニュー、特にいわゆる「ハンバーガーメニュー」などは、アイコンの視覚形状によってポップアップメニューが出ると推察できることが多いでしょう。しかしスクリーンリーダーの利用者には、そのような視覚形状は伝わらない場合があります。そのようなとき、この属性を利用すると、ポップアップメニューを出すボタンであることが伝わります。

属性値は"true"と"false"の他、以下のトークンを利用でき、何がボップアップするのかを示すことができます。

- menu
- listbox
- tree
- grid
- dialog

### `aria-expanded`ステート属性

`aria-expanded`属性を利用すると、その要素が所有しているか、もしくはコントロールしている要素の開閉状態を示すことができます。属性値として"true"か"false"のいずれかを指定し、"true"は開いている、"false"は閉じている状態を示します。

たとえば、ボタンを押すと開閉するメニューのようなものがあるとき、ボタンの方にこの属性を指定することで、現在の開閉状態を示すことができます。以下の例では、「パネルを開く」ボタンを押すことでその下の要素が開閉する想定です。

```html
<button type="button">パネルを開く</button>
<div id="panel01">
開くコンテンツ
</div>
```

「パネルを開く」を押すと文字通りパネルが開き、視覚環境ではパネルが開いていることがわかります。しかし、スクリーンリーダーの利用者の場合、現在パネルが開いているのかどうか分かりません。既に開いている状態なのに、そのことに気づかずにボタンを押して閉じてしまうかもしません。`aria-expanded`属性を利用することで、スクリーンリーダーの利用者にも開閉状態が伝わります。

```html
<button type="button" aria-expanded="true" aria-controls="panel01">パネルを開く</button>
<div id="panel01">
開くコンテンツ
</div>
```

この例の場合、多くのスクリーンリーダーは、ボタンにフォーカスすると「パネルを開く ボタン 開いています」などと読み上げます。これで、、このボタンの操作対象が現在すでに開いていることがわかります。なお、この例では、開閉操作の対象の要素が何であるのかを`aria-controls`属性で示しています。`aria-controls`属性については後述します。

`aria-expanded`属性はグローバル属性ではなく、指定できる要素がある程度絞られています。具体的には、以下のいずれかのロールを持つ要素でなければなりません。
	
- application
- button
- checkbox
- combobox
- gridcell
- link
- listbox
- menuitem
- row
- rowheader
- tab
- treeitem

基本的に、開閉を制御するボタンの方に指定することに注意してください。上記のように、開閉ボタンを操作する際の情報として役立てることが想定されています。

なお、ボタンのラベルや他のARIA属性から十分に状態が推測できる場合は、必ずしも`aria-expanded`を指定しなくても良い場合があります。たとえば、上記の例ではボタンのラベル自体が「パネルを開く」となっていますから、パネルが閉じている場合には`aria-expanded`属性がなくても伝わる可能性が高いでしょう。同様の理由で、`aria-haspopup`を持っている要素には`aria-expanded`を指定しなくても良い場合があります。

### `aria-controls`プロパティ属性

`aria-controls`属性を利用すると、その要素が制御する対象の要素を示すことができます。たとえば、メニューを開くボタンと開いたメニューを結びつけたり、タブとタブパネルを結び付けたりすることができます。

属性値は制御対象の要素のIDです。スペースで区切って複数を指定することもできます。

スクリーンリーダーは、制御対象の要素へジャンプする機能を提供することがあります。制御するボタンと制御対象の要素が離れていても、この機能を利用するとすぐに制御対象に移動することができます。

### `aria-level`プロパティ属性

`aria-level`属性は、要素の階層レベルを示します。属性値として整数を指定します。

典型的な利用法は、`heading`ロールを持つ要素の見出しレベルを示すことです。HTMLには`h1`〜`h6`の見出し要素が存在しますが、レベル7を超える見出し階層を表現したい場合や、何らかの理由で見出し要素が使えない場合に利用することができます。

```html
<div class="heading" aria-level="7">
見出し7
</div>
```

### `aria-live`プロパティ属性

`aria-live`属性を使用すると、要素を「ライブ領域」(live region)として定義することができます。

ライブ領域とは、内容が更新された際にユーザーに通知される領域です。支援技術のユーザーが特定の場所を読んでいる際、他の場所がリアルタイムで更新されても、その更新に気づかないことがあります。更新される領域をライブ領域として定義しておくと、更新された際にユーザーに通知されるため、他の場所を読んでいても更新に気づくことができます。たとえば、株価の表示、ゲームのスコア表示、緊急性の高いエラーメッセージなど、リアルタイムに更新され、かつユーザーに気付いて欲しい箇所に使用します。

`aria-live`属性に設定できる値は"off"、"polite"、"assertive"の3種類です。

`off`を指定した場合、ユーザーが該当のライブ領域にフォーカスしている時のみ変化が伝わります。他の要素にフォーカスしている場合には何も伝わりません。広告や時計など、あまり重要でない情報に対して利用します。

`polite`を指定した場合、ライブ領域の変化は、スクリーンリーダーのタスクが一段落した時点で通知されます。たとえば、スクリーンリーダーが他の箇所を読み上げている場合は、その読み上げが終わってから通知が行われることになります。

`assertive`を指定した場合、ライブ領域の変化は即座に伝えられます。スクリーンリーダーが他の箇所を読み上げている場合、その読み上げを強制的に中断することになります。極めて緊急性の高い通知を行うときにのみ使用するようにしてください。

ARIAロールの中には、ロールの特性としてライブ領域の機能を持つものもあり、以下の5つのロールが該当します。括弧内は`aria-live`のデフォルト値です。

- alert (assertive)
- log (polite)
- marquee (off)
- status (polite)
- timer (off)

ライブ領域が機能するためには、ドキュメントが読み込まれた時点であらかじめライブ領域として設定されていなければなりません。JavaScriptによって動的に`aria-live`属性を追加したり、`role`属性を上記のものに変更したりしても、その要素はライブ領域にはなりませんので注意が必要です。

<!-- 以下調整中 -->



## ARIAの基本ルール

ARIAにはさまざまな属性が定義されていますが、どのような方針ARIAをHTMLで使用すればよいのでしょうか。前節で紹介したUsing ARIAでは、ARIAの利用方法の指針を示す5つのルールが挙げられています。この5つのルールについて、順を追って説明します。

<!-- 参考訳：Using WAI-ARIA in HTML（日本語訳）https://imagedrive.github.io/spec/using_wai-aria_in_html.xhtml -->

<!--1～5はままコピーあり-->
### ARIAルール1. HTML自身に備わっている機能を利用する

HTMLに元々備わっているネイティブな機能でARIAと同等の表現ができる場合、HTMLの機能を使用します。これは以下のような言い方で表現されることもあります。

「ARIAを使う際に最も注意すべきことは、ARIAを使わないようにすることです。」

以下の2つのHTMLコードは同じ意味です。

<!-- 望ましくない例 -->
```html
<div role="main">
<div role="heading" aria-level="1">メインコンテンツ</div>
...
</div>
```

<!-- 望ましい例 -->
```html
<main>
<h1>メインコンテンツ</h1>
...
</main>
```

しかし、前者は後者に比べ明らかに冗長で、望ましくありません。さらに、ネイティブセマンティクスとWAI-ARIAのセマンティクスとを同時に使用する状況もありえます。

<!-- 望ましくない例 -->
```html
<main role="main">
<h1 role="heading" aria-level="1">メインコンテンツ</h1>
...
</main>
```

これもやはり望ましくありません。ARIAの機能と全く同一の機能がネイティブで利用できる場合は、ネイティブの機能だけを使用し、ARIAを使わないようにすることが推奨されます。

プロパティやステートも同様です。たとえば、チェックボックスに対して「チェックされている」という状態を表現したい場合、ARIAの`aria-checked`を使うべきではありません。以下は望ましくない例です。

<!-- 望ましくない例 -->
```html
<input type="checkbox" aria-checked="false">
```

これは単に冗長なだけでなく、JavaScriptなどから値を制御しなければならないという問題もあります。上記の例でチェックボックスがチェックされても、`aria-checked`の値が自動で`true`に変わることはなく、支援技術にはチェックされていない状態として通知されてしまいます。

以下のように、HTMLの`checked`属性を使いましょう。

<!-- 望ましい例 -->
```html
<input type="checkbox" checked>
```

### ARIAルール2. ネイティブのセマンティックスをむやみに変更しない

ARIA in HTMLで許されている組み合わせであっても、不用意なセマンティクスの変更は望ましくありません。以下の例は許されており、文法エラーにはなりませんが、望ましくない例です。

<!-- 望ましくない例 -->
```html
<div role="tablist">
<h2 role="tab">見出しタブ</h2>
</div>
```

この例では`h2`要素のロールを変更しているため、見出しであることが伝わらなくなります。この場合は以下のようにするとよいでしょう。

<!-- 望ましい例 -->
```html
<div role="tablist">
<div role="tab"><h2>見出しタブ</h2></div>
</div>
```

### ARIAルール3. インタラクティブなコントロールはキーボード操作可能にする

HTMLには、ユーザーが操作可能なコントロールが多数ありますが、それらでは要件が満たせないこともあります。そんなときコンテンツ製作者は、JavaScriptを駆使して、オリジナルのウィジェットを作りだし、ARIAを使ってロールを与えることがあります。

このようなインタラクティブなコントロールを作成した場合、キーボードでも操作できるようにしなければなりません。ユーザーがクリック、タップ、ドラッグ、ドロップ、スライド、スクロールといった各種の操作を行える時、キーボードのみの環境でも同等の操作を実現できるようにする必要があります。

たとえば、以下のように`div`要素に`role=button`を指定すると、この要素はボタンとしてのセマンティクスを持ち、支援技術にはボタンであると伝えられます。ボタンを押した際の動作は`onclick`属性に記述したJavaScriptで実現しています。

```html
<div role="button" onclick="pushed()">素敵なボタン</div>
<script>
const pushed = () =>{
    alert('押されました'); // ボタンを押された時の処理
}
</script>
```

この`div`ボタンはマウスでクリックすると動作し、一見すると問題ないように見えるかもしれませんが、以下のような機能がありません。

- キーボードの<kbd>Tab</kbd>キーでフォーカスを当てる
- キーボードの<kbd>Enter</kbd>キー、<kbd>Return</kbd>キー、<kbd>space</kbd>キーでボタンを押す

つまりキーボード操作をすることができません。このような場合には、キーボード操作に対応する機能を明示的に実装する必要があります (ルールその1に従ってHTMLの`button`要素を用いれば、これらの機能はネイティブの機能として提供されることになります)。

### ARIAルール4. フォーカス可能な要素を隠さない

要素に`aria-hidden="true"`を指定すると、支援技術からその要素を隠すことができます。その要素は、視覚環境では表示され、しかしスクリーンリーダーでは読まれなくなります。

フォーカス可能な要素に`aria-hidden="true"`を指定した場合、不都合が起きます。その要素は支援技術には「見えない」のですが、視覚環境では表示されており、フォーカスは当たります。支援技術の利用者の場合、見えない要素にフォーカスが当たり、フォーカスを見失ってしまいます。

<!-- 望ましくない例 -->
```html
<button aria-hidden="true">支援技術に「見えない」がフォーカスは当たるボタン</button>
```

なお、フォーカスが当たらなければ問題はおきません。視覚環境も含めた全ての環境から要素を隠したり、無効にするなどしてフォーカスが当たらないようにすれば問題を回避できます。以下はこの問題が起きない例です。

<!-- 問題のない例 -->
```html
<button hidden>全ての環境から隠されたボタン</button>
<button aria-hidden="true" disabled>無効のボタン</button>
<button aria-hidden="true" tabindex="-1">フォーカスの当たらないボタン</button>
```

### ARIAルール5. インタラクティブな要素にアクセシブルな名前を持たせる

インタラクティブな要素には、「アクセシブルな名前」（accessible name）をつけなければなりません（詳細は後述します）。以下は不適切な例です。

<!-- 不適切な例 -->
```html
<span>ユーザー名</span>
<input type="text">
```

入力欄の隣にテキストがあり、視覚環境であれば、この入力欄に「ユーザー名」を入れれば良いことがわかるかもしれません。しかし、このテキストは`input`要素と関連づけられておらず、アクセシブルな名前を持っているとは言えません。スクリーンリーダーの利用者が入力欄にフォーカスした場合、「テキスト入力」などと読まれるだけで、何を入力すれば良いのかわからないことがあります。

次のように`label`要素としてマークアップし、`input`要素に関連づけることで、この入力欄に「ユーザー名」というアクセシブルな名前を与えることができます。

<!-- 望ましい例 -->
```html
<label>ユーザー名
<input type="text"></label>

<label for="uname">ユーザー名</label>
<input type="text" id="uname">
```

このようにすると、入力欄にフォーカスした際に「ユーザー名 テキスト入力」のように読まれ、何を入力するのかがわかります。

アクセシブルな名前を与える方法はいくつかあり、`title`属性やARIAのプロパティを使用する方法もあります。

<!-- 問題ない例 -->
```html
<input type="text" title="検索">

<input type="text" aria-label="検索">

<span id="search-label">検索</span>
<input type="text" aria-labelledby="search-label">
```

ヘッダの検索フォームなど、可視のラベルを用意することが難しいケースでは、属性を利用しても良いでしょう。




## ARIAのロールと分類

執筆時点で最新のW3C勧告であるWAI-ARIA 1.1では、全部で81のロールが定義されています。ARIA仕様の"5.3 Categorization of Roles"[^1]では、ARIAロールを6つの観点から分類しています。

[^1]: <https://www.w3.org/TR/wai-aria-1.1/#roles_categorization>

<!-- 以下の説明は仕様本体の説明に対して大幅に説明を加えている。これでいいのか悩ましいところだが、抽象ロールの意義を説明するためにはこのような説明が必要であるように思えるし、その流れで以下を説明すると伝わりやすいように思っている。検討の余地はあり -->

### 抽象ロール

ARIAのロールには継承、派生の関係があります。これは、オブジェクト指向プログラミング言語におけるクラスの継承と同じ概念です。同様に「抽象」(abstract)の概念もあります。抽象ロールは、他のロールの上位概念を定義するためのロールで、実際にコンテンツ内で使うことはできないものです。

逆に、実際にコンテンツ内で使えるロールは「具象」(concrete)ロールと呼びます。[^1]

[^1]: もっとも、この呼称はマイナーで、ARIA仕様内では 7.1 Role Attribute で concrete WAI-ARIA role として使われている一度きりしか出てきません。

ARIAのロールの継承関係は、基底(base)ロールである`roletype`ロールから始まります。他のロールはすべて`roletype`から派生します。`roletype`ロールからは以下の3つのロールが派生します。

- structure
- widget
- window

この3つは全て抽象ロールです。他のARIAロールは、この3つのいずれかから派生します。つまり、全てのロールは上記3つのいずれかに分類できるということです。

これら3つからは、直接に具象ロールが派生することもありますし、さらに抽象ロールが派生することもあります。以下の8つは抽象ロールです。

- command
- composite
- input
- landmark
- range
- section
- sectionhead
- select

ARIA仕様の"5.3 Categorization of Roles"では、ロールの派生関係のすべてを図で見ることもできます。

### 文書構造ロール

`structure`抽象ロールから派生したロールのうち、特別な機能を持たないもの (後述するランドマークロール、ライブリージョンに該当しないもの) を「文書構造」(Document Structure)ロールと呼びます。これは主に、ページ内のコンテンツの構造を説明するものです。基本的には静的なものであり、ユーザーの操作に反応することはありません。

`structure`抽象ロールからは以下の8つのロールが派生します。

- application
- document
- presentation, none
- rowgroup
- separator
- section (抽象ロール)
- sectionhead (抽象ロール)

`section`抽象ロールからは`list`ロール、`table`ロールなどが派生し、`sectionhead`抽象ロールからは`heading`ロールなどが派生します。全部で26の具象ロールが文書構造ロールに属します。
<!--
application
article
cell
columnheader
definition
directory
document
feed
figure
group
heading
img
list
listitem
math
none
note
presentation
row
rowgroup
rowheader
separator (when not focusable)
table
term
toolbar
tooltip
-->
`section`が抽象ロールであることに注意してください。HTMLの`section`要素に相当するのは`region`ロールのほうです。`region`ロールは`structure`>`section`>`landmark`>`region`という派生関係にあり、後述のランドマークロールに属します。

### ウィジェットロール

`widget`抽象ロールから派生したロールをウィジェットロールと呼びます。ユーザーインターフェイスウィジェットとして機能するものであり、ユーザーの操作に反応するインタラクティブなものです。

`widget`抽象ロールからは以下の8つのロールが派生します。

- command (抽象ロール)
- composite (抽象ロール)
- gridcell
- input (抽象ロール)
- range (抽象ロール)
- row
- separator
- tab

`command`抽象ロールからは`button`などが、`input`抽象ロールからは`textbox`ロールなどが派生し、全部で29の具象ロールがウィジェットロールに属します。
<!--
button
checkbox
gridcell
link
menuitem
menuitemcheckbox
menuitemradio
option
progressbar
radio
scrollbar
searchbox
separator (when focusable)
slider
spinbutton
switch
tab
tabpanel
textbox
treeitem
-->
なお、`composite`抽象ロールから派生するものは、単独で機能するものではなく、他の要素を制御したり、他の要素のコンテナとなるものです。`combobox`や`tablist`などが該当します。

### ウィンドウロール

`window`抽象ロールから派生したロールをウィンドウロールと呼びます。ブラウザー内やアプリケーション内において、サブウィンドウやモーダルダイアログとして機能するものです。以下の2つが派生します。

- `alertdialog`
- `dialog`

これらはいずれも具象ロールです。

### ランドマークロール

`landmark`抽象ロールから派生するロールを、ランドマークロールと呼びます。ランドマークロールはその名の通り、ナビゲーションの際のランドマークとして機能するものです。支援技術の多くは、ランドマークを利用したナビゲーションの機能を持ちます。ユーザーの操作に大きく影響する重要なロールであると言えます。

以下の8つがランドマークロールです。

- banner
- complementary
- contentinfo
- form
- main
- navigation
- region
- search

`landmark`抽象ロールは、`structure`>`section`>`landmark`という派生関係にあり、これらは`structure`の派生ロールでもあります。分類の仕方によっては文書構造ロールに分類されることもあります。

### ライブ領域ロール

「ライブ領域」(live region)とは、内容が更新された際にユーザーに通知される領域です。支援技術のユーザーが特定の場所を読んでいる際、他の場所がリアルタイムで更新されても、その更新に気づかないことがあります。更新される領域をライブ領域として定義しておくと、更新された際にユーザーに通知されるため、他の場所を読んでいても更新に気づくことができます。

リアルタイムに更新され、かつユーザーに気付いて欲しい箇所に使用します。たとえば、株価の表示、ゲームのスコア表示、緊急性の高いエラーメッセージなどに用いることが考えられます。

ライブ領域ロールは、以下の5つです。

- alert
- log
- marquee
- status
- timer

これらは`section`から派生しており、`structure`の派生ロールでもあります。分類の仕方によっては文書構造ロールに分類されることもあります。


## ARIAのプロパティとステート

プロパティとステートは似た性質を持つこともあり、ARIA仕様の分類では一括りに「属性」として扱われています。属性は以下の4つに分類されています。

### ウィジェット属性

「ウィジェット属性」(Widget Attributes)は、主にGUIシステムのユーザーインターフェイスに使用する属性です。HTMLでは、主にフォームコントロールに関連します。コントロールの状態を表す`aria-pressed`ステートや、ラベル付けのための`aria-label`プロパティなど、24の属性が含まれます。不要な情報を支援技術から隠すのに利用される`aria-hidden`も、ここに分類されます。

### ライブ領域属性

「ライブ領域属性」(Live Region Attributes)は、前述のライブ領域ロールと同じような働きをする属性です。ライブ領域ロールと組み合わせることもできますし、そうでない要素に指定して、任意の要素にライブ領域としての働きを持たせることもできます。

- aria-atomic
- aria-busy
- aria-live
- aria-relevant

### ドラッグアンドドロップ属性

「ドラッグアンドドロップ属性」(Drag-and-Drop Attributes)は、ドラッグアンドドロップのインターフェイスに関する情報を示す属性です。以下の2つがここに分類されます。

- aria-dropeffect
- aria-grabbed

### 関係属性

「関係属性」(Relationship Attributes)は、要素間の関係や関連性を示す属性です。要素間の関係は、要素の子孫関係といった文書構造から自明となる場合もありますが、そうでない場合に、これらの属性で関係性を明示することができます。

要素を説明文と結びつける`aria-describedby`属性、コントロールとコントロールの対象を結びつける`aria-controls`など、16の属性があります。表に関連する`aria-colcount`や`aria-rowspan`属性もここに属します。


## アクセシブルな名前について

前述しているARIAの使い方のARIAルール5.にあるアクセシブルな名前（accessible name）について、少し掘り下げてみます。これは、Accessible Name and Description Computation仕様にも定義されているように、簡潔に言えばユーザーインターフェイスの名前です。


この名前はアクセシビリティAPIを通して公開されるものです。スクリーンリーダーなどの支援技術はアクセシビリティAPIを通してコンテンツにアクセスするため、適切なアクセシブルな名前を付ける必要があります。

ARIAルール5.の再掲になりますが、ある入力欄がユーザー名であることを支援技術に伝えるには、例えば次のようにラベル付けするだけで十分です。

```
<label>ユーザー名 <input type="text"></label>
```

言い換えるならば、HTML標準に定められた要素を用いる限りでは、アクセシブルな名前について特段意識する必要はありません。

### どのような要素やARIA属性がアクセシブルな名前を与えるのか

正確な名前の決定方法については、Accessible Name and Description Computation仕様に定義されていますが、大まかに言ってしまえば、

- `aria-labelledby`属性
- `aria-label`属性
- `title`属性、`alt`属性、`label`要素などのHTMLネイティブの要素・属性

で与えることできます。優先順位としては`aria-labelledby`属性が最も高く、次に`aria-label`属性、その次にHTMLネイティブの要素・属性の順になります。

`aria-labelledby`属性と`aria-label`属性が同時に指定される場合、`aria-labelledby`属性が優先され`aria-label`属性は無視されます。

`aria-label`属性と`aria-labelledby`属性はどちらもアクセシブルな名前を与えますが、どのようなものなかについては、次に説明します。

#### `aria-labelledby`属性

`aria-labelledby`属性は、現在の要素のラベル付けする要素を特定するものです。HTMLの`label`要素に似た働きをしますが、`label`要素とは逆方向のラベル付けをします。

属性値は別の要素に付けられた`id`属性の値（複数の場合はスペース区切り）です。つまり、次のコード例のように2つ以上の要素を連結させることもできます。

```
<div id="billing">請求書</div>

<div>
    <div id="name">名前</div>
    <input type="text" aria-labelledby="billing name"/>
</div>
<div>
    <div id="address">住所</div>
    <input type="text" aria-labelledby="billing address"/>
</div>
```

1つ目の`input`要素は「請求書 名前」、2つ目の`input`要素は「請求書 住所」とラベル付けされます。

#### `aria-label`属性

`aria-label`属性は、現在の要素のラベル付けする文字列を定義するものです。HTMLの`title`属性に似たコンセプトを持ちます。

使用例としては、次のコード例のような、単に「X」とだけ記載されているようなボタンが挙げられます。「ダイアログを閉じる」というボタンの目的を示すものは何もないので、`aria-label`属性が支援技術にラベルを知らせる目的で使用されます。

```
<button aria-label="閉じる" onclick="myDialog.close()">X</button>
```

WAI-ARIA仕様に記述されているように、画面上で可視のテキストとして表現できるラベルである場合、`aria-label`属性を使用すべきではありません。属性値であるため、画面上に何も表示されないことに注意します。あくまで、可視のラベルや可視のツールチップが望ましくないケースでこの属性の使用を検討します。



<!-- メモ
4-2を一通り見ましたが、
4-1では具体的な属性の紹介をしているのに、4-2ではARIAの概要と属性の分類だけの紹介になっていて、内容にかなりギャップがあり違和感がある。
もともと4-2はARIAの章として独立で書いていたものを、属性のところに持ってきたことが原因。
以下のように再整理してはどうか。

- ARIAの概要
- ARIAの一般的な注意点
- よく使用するARIA属性

role属性
https://www.w3.org/TR/wai-aria-1.2/#host_general_role

heading
button
presentation

aria-hidden
aria-label
aria-labelledby
aria-describedby
aria-current
aria-expanded
aria-controls

 -->


<!-- ロールの話、プロパティとステートの話が何度も出てくるので一箇所にまとめる -->
<!-- プロパティとステートのところで真偽値属性の使い方について書く -->
<!-- role の複数指定

 -->
<!-- ARIA仕様の読み方に触れたい。仕様の個々のロールの表の内容がすでに難しい -->


