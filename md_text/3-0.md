# 要素解説の注意点

Chapter3では、HTMLのそれぞれの要素について簡単に説明し、その性質や注意点について述べていきます。ここでは、本書の要素解説についての注意点や、必要となる前提知識について説明します。

## 本書における要素解説の注意

本書ではHTMLの各要素について説明しています。ただし、すべての要素を網羅しているわけではなく、利用頻度の低い要素は取り上げていないことがあります。正確な要素の一覧は、仕様を参照してください。

本書では、HTMLの要素について、以下の順で説明しています。

- 全般的な説明
- 内容モデル
- 属性
- アクセシビリティ上の注意点

### 全般的な説明

要素名の見出しのすぐ後には、その要素についての説明があります。要素の意味（セマンティクス）や利用方法、利用時に注意が必要な点などを説明しています。

#### 構文ルール、構文エラー

説明の中では、HTMLの構文ルールについて触れていることがあります。本書で触れる字句的ルールは、原則として仕様に沿った解説としています。語彙的ルールや意味論的ルールには解釈の幅があることが多く、著者の価値観が反映されている場合があります。

#### 要素の見た目とデフォルトスタイル

説明の中で、要素の見た目について言及している場合があります。HTMLの要素は見た目を表現するものではなく、その見た目はCSSによって別途与えられます。また、コンテンツ制作者が指定したスタイルとは別に、ユーザーによってスタイルが与えられたり、設定によってスタイルが変更されることもあります。

ブラウザーは、CSSによる指定がない場合のデフォルトのスタイルを持っています。ブラウザーのデフォルトスタイルには、仕様で規定されている場合もあります（たとえば`hidden`属性が指定された場合）が、多くの場合はブラウザーの実装や、OSなどの環境に依存して変化します。本書で要素の見た目に言及する際には、一般的なブラウザーで多く採用しているデフォルトスタイルを参考にしています。

要素の見た目はCSS、ブラウザー、OS、支援技術、ユーザーの設定など、さまざまな要因によって変化することに注意してください。

#### アウトライン

要素の中には、文書のアウトラインに影響するとされているものがあります。

一般に、文書は複数の章や節から構成され、それぞれの冒頭には見出しが置かれます。このような、文書の一部分のまとまりを「セクション」（section）と呼びます。セクションとその見出しには階層構造があり、たとえば以下の図のように表現できます。

```text
├ 1章見出し
├ 2章見出し
│ ├ 2.1節見出し
│ │ └ 2.1.1項見出し
│ └ 2.2節見出し
└ 3章見出し
```

図3-00-01 アウトラインの例

この図のように、セクションの深さと概要を示したものを「アウトライン」（outline）と呼びます。HTML仕様では、見出しやセクションなどのマークアップからアウトラインを決定する方法をルール化しており、「アウトラインアルゴリズム」（outline algorithm）と呼んでいます。アウトラインアルゴリズムの詳細は仕様を参照してください。

<https://html.spec.whatwg.org/multipage/sections.html#outlines>

ただし、ブラウザーや支援技術によるアウトラインアルゴリズムのサポートは良好とはいえません。W3C HTML 5.2仕様の"Creating an outline"のセクション[^3]では、アウトラインアルゴリズムを解釈する適合性チェッカーはあるが、ブラウザーや支援技術の実装は知られていない、という旨の記述があります。

[^3]: https://www.w3.org/TR/2021/SPSD-html52-20210128/sections.html#creating-an-outline

また、アウトラインアルゴリズムに関しては、大幅に仕様を変更してはどうかという提案もあります。[^4]

[^4]: https://github.com/whatwg/html/pull/3499

本書では仕様に沿ってアウトラインアルゴリズムについて解説しますが、実際に機能するとは限らないことに注意してください。

### 内容モデル

内容モデルのセクションでは、要素の内容モデルの定義について説明しています。内容モデルについてはChapter2-4を参照してください。

#### script-supporting elements

多くの要素は、内容にscript-supporting elementsを含めることができます。script-supporting elementsは`script`要素と`template`要素を指すもので、ほぼすべての要素に入れることができます。本書では、内容モデルの説明からscript-supporting elementsを省いています。

#### インタラクティブ要素

一部の要素は、内容モデルに「インタラクティブ要素」(Interactive elements)を含められないという制約を持ちます。

ウェブページには、ユーザーの操作に動的に反応（インタラクション）する仕組みを設けることができます。ユーザーの操作とは、リンクをクリックする、ボタンを押す、プルダウンメニューをクリックして展開する、といったものです。このようなユーザーの操作に反応する要素を「インタラクティブ要素」(Interactive elements)と呼びます。

インタラクティブ要素の代表例はリンクを表現する`a`要素、ボタンの`button`要素です。ただし`a`要素の場合、`href`属性を指定しなければインタラクティブにはなりません。このように、特定の要素が条件によってインタラクティブかどうかが決まる場合があります。

`tabindex`属性を利用すると、任意の要素をインタラクティブにできます。`tabindex`属性によってインタラクティブとなった要素も、内容モデルにおいてインタラクティブ要素として扱われることに注意してください。以下は構文エラーとなる例です。

```html
<a href="/example">
  <span tabindex="0">example</span>
</a>
```

通常は`a`要素の内容に`span`要素を入れられますが、この例では`tabindex`属性によってインタラクティブになっているため、構文エラーとなります。

#### 終了タグの省略

Chapter2-1で説明したように、要素の終了タグは仕様略できる場合があります。しかし本書では、原則として要素の終了タグの省略可否を明言していません。これは、内容を持つ要素の終了タグは省略しないことをお勧めしているためです。省略可否を知りたい場合には、仕様を参照してください。

ただし、内容モデルがNothingとされている要素については、終了タグを書いてはならないとされている場合があります。終了タグを書いてはならない要素については、内容モデルの説明の中でその旨を明記しています。

### 属性

属性の項では、その要素に指定できる属性を説明しています。ただし、利用頻度の低いものや、JavaScriptと組み合わせて利用するものなどについては、説明を省いていることがあります。正確な情報は仕様を参照してください。

#### グローバル属性

HTMLでは、すべての要素に指定できるグローバル属性が定義されています。グローバル属性については、個々の要素では扱いません。Chapter4-1を参照してください。

グローバル属性以外の固有の属性を持たない要素については、属性の説明そのものを省略しています。

また、複数の要素に共通して指定できる属性を持つ場合は、個々の要素のセクションではなく、別のセクションでまとめて説明していることがあります。

#### IDL属性

JavaScriptから要素の属性にアクセスする場合、その方法は大きく2種類あります。1つは、DOMインターフェイスの`getAttribute()`メソッドや`setAttribute()`メソッドを利用する方法です。

```html
<label id="label01" for="control01">test label</label>
<script>
const labelElement = document.getElementById('label01');

alert(labelElement.getAttribute("id")); // label01
alert(labelElement.getAttribute("for")); // control01
</script>
```

もう1つは、「IDL属性」(IDL attribute)を利用する方法です。取得した要素のオブジェクトのプロパティに直接アクセスする方法で、上記の例は以下のように書くことができます。

```html
<label id="label01" for="control01">test label</label>
<script>
const labelElement = document.getElementById('label01');

alert(labelElement.id); // label01
alert(labelElement.htmlFor); // control01
</script>
```

通常、IDL属性はHTMLの属性名と同じ名前ですが、異なる名前が用いられることもあります。上記の例では、`label`要素の`for`属性にアクセスするために、`for`プロパティではなく`htmlFor`プロパティを参照しています。

これはHTML仕様で定義されており、IDL (Interface Description Language、インターフェイス記述言語)という言語で記述されています（実際は逆の関係で、IDLで記述されたインターフェイスであるためにIDL属性と呼びます）。

本書では、特段の注意点がない場合にはIDL属性について触れていません。IDL属性について知りたい場合は、HTML仕様を参照してください。
<!-- https://developer.mozilla.org/ja/docs/Glossary/IDL -->

#### 廃止された属性

属性の説明に「廃止された属性」と書かれているものがあります。これは、過去のHTML仕様で定義されていたものの、現在のHTMLでは廃止された属性です。コンテンツ制作者は、廃止された属性を利用してはなりません。

ブラウザーは互換性のために、廃止された属性について特別な処理を行うことがあります。Chapter1-7の「旧式だが適合する機能」も参照してください。

### アクセシビリティ上の注意点

本書では、各要素のアクセシビリティ上の注意点について述べています。

#### スクリーンリーダーによる読み上げ

本書では、スクリーンリーダーによる読み上げの際の挙動について説明していることがあります。挙動はスクリーンリーダーによって異なることに注意してください。後述の「デフォルトのARIAロール」の項も参照してください。

#### デフォルトのARIAロール

アクセシビリティ上の注意点として、各要素のデフォルトのARIAロールについて説明しています。ARIAロールについてはChapter4-2を参照してください。

本書では、2021年12月時点でのARIA in HTMLによる定義を参照しています。これはWAI-ARIA 1.1の勧告と連動した定義です。WAI-ARIA 1.2での更新予定について言及していることがありますが、WAI-ARIA 1.2は2021年12月時点では勧告になっておらず、予定が変更となる可能性があることに注意してください。

Chapter1-2で触れたように、支援技術はアクセシビリティツリーの情報を参照します。アクセシビリティツリーにはARIAロールの情報が反映されるため、要素が持つARIAロールによって支援技術の挙動が変化します。たとえば、ARIAロール`link`を持つ要素があれば、スクリーンリーダーは「リンク」と読み上げます。このように、要素のロールはスクリーンリーダーの読み上げと密接な関係があります。

多くの要素にはデフォルトのARIAロールがありません（ARIA in HTMLでは"no corresponding role"と定義されています）。この場合、原則として、支援技術はその要素を特別扱いしません。スクリーンリーダーであれば、「リンク」のような特別な通知をせず、単に内容のテキストを読み上げます。

支援技術によっては、ARIAロールがない要素でも独自の挙動をする場合があります。本書では、特別な挙動が確認できている場合に、その挙動を説明していることがあります。すべての支援技術が同様に動作するわけではないことに注意してください。

要素の中には、条件によってデフォルトのARIAロールが変化するものもあります。たとえば、`img`要素は`alt`属性の値によってARIAロールが変化することがあります。また、「アクセシブルな名前」（accessible name）の有無によってロールが変化することもあります。アクセシブルな名前についてはChapter4-2を参照してください。

#### ランドマーク

本書では、ランドマークについて言及していることがあります。

「ランドマーク」（landmark）とは、目印となるような大きな建造物のことです。遠くからでもはっきりと見える目印は、自分がどこにいるのか、どちらへ行けば良いかを知るのに役立ちます。ウェブページにおいては、ヘッダーやフッター、サイトナビゲーション、ページの主要部分など、大きな目印となるものをランドマークと呼んでいます。

スクリーンリーダーなどの支援技術は、ランドマークにジャンプしたり、ランドマークをスキップしたりする機能を提供することがあります。これによって、本文をすぐに読み始めたり、利用する必要のない部分を読み飛ばしたりすることが可能になります。

要素がランドマークロールと呼ばれるARIAロールを持つ場合、その要素はランドマークとして扱われます。ランドマークロールの詳細はChapter4-2を参照してください。

一部の要素は、デフォルトのARIAロールとしてランドマークロールを持ちます。`nav`要素、`aside`要素、`header`要素、`footer`要素などが該当します。`section`要素や`form`要素は、アクセシブルな名前を与えられた場合のみランドマークとして機能します。アクセシブルな名前についてはChapter4-2を参照してください。
